{"version":3,"file":"UsersListPage.7b075a18e072d368f511.js","mappings":"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","sources":["webpack://grafana/./public/app/features/invites/InviteeRow.tsx","webpack://grafana/./public/app/features/invites/InviteesTable.tsx","webpack://grafana/./public/app/features/invites/state/selectors.ts","webpack://grafana/./public/app/features/users/state/selectors.ts","webpack://grafana/./public/app/features/users/UsersActionBar.tsx","webpack://grafana/./public/app/features/users/state/actions.ts","webpack://grafana/./public/app/features/users/UsersListPage.tsx","webpack://grafana/./public/app/features/users/UsersTable.tsx"],"sourcesContent":["import React, { PureComponent } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\n\nimport { Button, ClipboardButton } from '@grafana/ui';\nimport { Invitee } from 'app/types';\n\nimport { revokeInvite } from './state/actions';\n\nconst mapDispatchToProps = {\n  revokeInvite,\n};\n\nconst connector = connect(null, mapDispatchToProps);\n\ninterface OwnProps {\n  invitee: Invitee;\n}\n\nexport type Props = OwnProps & ConnectedProps<typeof connector>;\n\nclass InviteeRow extends PureComponent<Props> {\n  render() {\n    const { invitee, revokeInvite } = this.props;\n    return (\n      <tr>\n        <td>{invitee.email}</td>\n        <td>{invitee.name}</td>\n        <td className=\"text-right\">\n          <ClipboardButton icon=\"copy\" variant=\"secondary\" size=\"sm\" getText={() => invitee.url}>\n            Copy Invite\n          </ClipboardButton>\n          &nbsp;\n        </td>\n        <td>\n          <Button\n            variant=\"destructive\"\n            size=\"sm\"\n            icon=\"times\"\n            onClick={() => revokeInvite(invitee.code)}\n            aria-label=\"Revoke Invite\"\n          />\n        </td>\n      </tr>\n    );\n  }\n}\n\nexport default connector(InviteeRow);\n","import React, { PureComponent } from 'react';\n\nimport { Invitee } from 'app/types';\n\nimport InviteeRow from './InviteeRow';\n\nexport interface Props {\n  invitees: Invitee[];\n}\n\nexport default class InviteesTable extends PureComponent<Props> {\n  render() {\n    const { invitees } = this.props;\n\n    return (\n      <table className=\"filter-table form-inline\">\n        <thead>\n          <tr>\n            <th>Email</th>\n            <th>Name</th>\n            <th />\n            <th style={{ width: '34px' }} />\n          </tr>\n        </thead>\n        <tbody data-testid=\"InviteesTable-body\">\n          {invitees.map((invitee, index) => {\n            return <InviteeRow key={`${invitee.id}-${index}`} invitee={invitee} />;\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n","import { createSelector } from '@reduxjs/toolkit';\n\nimport { selectors } from './reducers';\n\nexport const { selectAll, selectById, selectTotal } = selectors;\n\nconst selectQuery = (_: any, query: string) => query;\nexport const selectInvitesMatchingQuery = createSelector([selectAll, selectQuery], (invites, searchQuery) => {\n  const regex = new RegExp(searchQuery, 'i');\n  const matches = invites.filter((invite) => regex.test(invite.name) || regex.test(invite.email));\n  return matches;\n});\n","import { UsersState } from 'app/types';\n\nexport const getUsers = (state: UsersState) => {\n  const regex = new RegExp(state.searchQuery, 'i');\n\n  return state.users.filter((user) => {\n    return regex.test(user.login) || regex.test(user.email) || regex.test(user.name);\n  });\n};\n\nexport const getUsersSearchQuery = (state: UsersState) => state.searchQuery;\nexport const getUsersSearchPage = (state: UsersState) => state.searchPage;\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport { RadioButtonGroup, LinkButton, FilterInput } from '@grafana/ui';\nimport { contextSrv } from 'app/core/core';\nimport { AccessControlAction, StoreState } from 'app/types';\n\nimport { selectTotal } from '../invites/state/selectors';\n\nimport { setUsersSearchQuery } from './state/reducers';\nimport { getUsersSearchQuery } from './state/selectors';\n\nexport interface Props {\n  searchQuery: string;\n  setUsersSearchQuery: typeof setUsersSearchQuery;\n  onShowInvites: () => void;\n  pendingInvitesCount: number;\n  canInvite: boolean;\n  showInvites: boolean;\n  externalUserMngLinkUrl: string;\n  externalUserMngLinkName: string;\n}\n\nexport class UsersActionBar extends PureComponent<Props> {\n  render() {\n    const {\n      canInvite,\n      externalUserMngLinkName,\n      externalUserMngLinkUrl,\n      searchQuery,\n      pendingInvitesCount,\n      setUsersSearchQuery,\n      onShowInvites,\n      showInvites,\n    } = this.props;\n    const options = [\n      { label: 'Users', value: 'users' },\n      { label: `Pending Invites (${pendingInvitesCount})`, value: 'invites' },\n    ];\n    const canAddToOrg: boolean = contextSrv.hasAccess(AccessControlAction.OrgUsersAdd, canInvite);\n\n    return (\n      <div className=\"page-action-bar\" data-testid=\"users-action-bar\">\n        <div className=\"gf-form gf-form--grow\">\n          <FilterInput\n            value={searchQuery}\n            onChange={setUsersSearchQuery}\n            placeholder=\"Search user by login, email or name\"\n          />\n        </div>\n        {pendingInvitesCount > 0 && (\n          <div style={{ marginLeft: '1rem' }}>\n            <RadioButtonGroup value={showInvites ? 'invites' : 'users'} options={options} onChange={onShowInvites} />\n          </div>\n        )}\n        {canAddToOrg && <LinkButton href=\"org/users/invite\">Invite</LinkButton>}\n        {externalUserMngLinkUrl && (\n          <LinkButton href={externalUserMngLinkUrl} target=\"_blank\" rel=\"noopener\">\n            {externalUserMngLinkName}\n          </LinkButton>\n        )}\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps(state: StoreState) {\n  return {\n    searchQuery: getUsersSearchQuery(state.users),\n    pendingInvitesCount: selectTotal(state.invites),\n    externalUserMngLinkName: state.users.externalUserMngLinkName,\n    externalUserMngLinkUrl: state.users.externalUserMngLinkUrl,\n    canInvite: state.users.canInvite,\n  };\n}\n\nconst mapDispatchToProps = {\n  setUsersSearchQuery,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UsersActionBar);\n","import { getBackendSrv } from '@grafana/runtime';\nimport { accessControlQueryParam } from 'app/core/utils/accessControl';\nimport { OrgUser } from 'app/types';\n\nimport { ThunkResult } from '../../../types';\n\nimport { usersLoaded } from './reducers';\n\nexport function loadUsers(): ThunkResult<void> {\n  return async (dispatch) => {\n    const users = await getBackendSrv().get('/api/org/users', accessControlQueryParam());\n    dispatch(usersLoaded(users));\n  };\n}\n\nexport function updateUser(user: OrgUser): ThunkResult<void> {\n  return async (dispatch) => {\n    await getBackendSrv().patch(`/api/org/users/${user.userId}`, { role: user.role });\n    dispatch(loadUsers());\n  };\n}\n\nexport function removeUser(userId: number): ThunkResult<void> {\n  return async (dispatch) => {\n    await getBackendSrv().delete(`/api/org/users/${userId}`);\n    dispatch(loadUsers());\n  };\n}\n","import React, { PureComponent } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\n\nimport { renderMarkdown } from '@grafana/data';\nimport { HorizontalGroup, Pagination, VerticalGroup } from '@grafana/ui';\nimport { Page } from 'app/core/components/Page/Page';\nimport { contextSrv } from 'app/core/core';\nimport { OrgUser, OrgRole, StoreState } from 'app/types';\n\nimport InviteesTable from '../invites/InviteesTable';\nimport { fetchInvitees } from '../invites/state/actions';\nimport { selectInvitesMatchingQuery } from '../invites/state/selectors';\n\nimport UsersActionBar from './UsersActionBar';\nimport UsersTable from './UsersTable';\nimport { loadUsers, removeUser, updateUser } from './state/actions';\nimport { setUsersSearchQuery, setUsersSearchPage } from './state/reducers';\nimport { getUsers, getUsersSearchQuery, getUsersSearchPage } from './state/selectors';\n\nfunction mapStateToProps(state: StoreState) {\n  const searchQuery = getUsersSearchQuery(state.users);\n  return {\n    users: getUsers(state.users),\n    searchQuery: getUsersSearchQuery(state.users),\n    searchPage: getUsersSearchPage(state.users),\n    invitees: selectInvitesMatchingQuery(state.invites, searchQuery),\n    externalUserMngInfo: state.users.externalUserMngInfo,\n    hasFetched: state.users.hasFetched,\n  };\n}\n\nconst mapDispatchToProps = {\n  loadUsers,\n  fetchInvitees,\n  setUsersSearchQuery,\n  setUsersSearchPage,\n  updateUser,\n  removeUser,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\nexport type Props = ConnectedProps<typeof connector>;\n\nexport interface State {\n  showInvites: boolean;\n}\n\nconst pageLimit = 30;\n\nexport class UsersListPage extends PureComponent<Props, State> {\n  declare externalUserMngInfoHtml: string;\n\n  constructor(props: Props) {\n    super(props);\n\n    if (this.props.externalUserMngInfo) {\n      this.externalUserMngInfoHtml = renderMarkdown(this.props.externalUserMngInfo);\n    }\n\n    this.state = {\n      showInvites: false,\n    };\n  }\n\n  componentDidMount() {\n    this.fetchUsers();\n    this.fetchInvitees();\n  }\n\n  async fetchUsers() {\n    return await this.props.loadUsers();\n  }\n\n  async fetchInvitees() {\n    return await this.props.fetchInvitees();\n  }\n\n  onRoleChange = (role: OrgRole, user: OrgUser) => {\n    const updatedUser = { ...user, role: role };\n\n    this.props.updateUser(updatedUser);\n  };\n\n  onShowInvites = () => {\n    this.setState((prevState) => ({\n      showInvites: !prevState.showInvites,\n    }));\n  };\n\n  getPaginatedUsers = (users: OrgUser[]) => {\n    const offset = (this.props.searchPage - 1) * pageLimit;\n    return users.slice(offset, offset + pageLimit);\n  };\n\n  renderTable() {\n    const { invitees, users, setUsersSearchPage } = this.props;\n    const paginatedUsers = this.getPaginatedUsers(users);\n    const totalPages = Math.ceil(users.length / pageLimit);\n\n    if (this.state.showInvites) {\n      return <InviteesTable invitees={invitees} />;\n    } else {\n      return (\n        <VerticalGroup spacing=\"md\">\n          <UsersTable\n            users={paginatedUsers}\n            orgId={contextSrv.user.orgId}\n            onRoleChange={(role, user) => this.onRoleChange(role, user)}\n            onRemoveUser={(user) => this.props.removeUser(user.userId)}\n          />\n          <HorizontalGroup justify=\"flex-end\">\n            <Pagination\n              onNavigate={setUsersSearchPage}\n              currentPage={this.props.searchPage}\n              numberOfPages={totalPages}\n              hideWhenSinglePage={true}\n            />\n          </HorizontalGroup>\n        </VerticalGroup>\n      );\n    }\n  }\n\n  render() {\n    const { hasFetched } = this.props;\n    const externalUserMngInfoHtml = this.externalUserMngInfoHtml;\n\n    return (\n      <Page navId=\"users\">\n        <Page.Contents isLoading={!hasFetched}>\n          <>\n            <UsersActionBar onShowInvites={this.onShowInvites} showInvites={this.state.showInvites} />\n            {externalUserMngInfoHtml && (\n              <div className=\"grafana-info-box\" dangerouslySetInnerHTML={{ __html: externalUserMngInfoHtml }} />\n            )}\n            {hasFetched && this.renderTable()}\n          </>\n        </Page.Contents>\n      </Page>\n    );\n  }\n}\n\nexport default connector(UsersListPage);\n","import React, { FC, useEffect, useState } from 'react';\n\nimport { OrgRole } from '@grafana/data';\nimport { Button, ConfirmModal } from '@grafana/ui';\nimport { UserRolePicker } from 'app/core/components/RolePicker/UserRolePicker';\nimport { fetchRoleOptions } from 'app/core/components/RolePicker/api';\nimport { contextSrv } from 'app/core/core';\nimport { AccessControlAction, OrgUser, Role } from 'app/types';\n\nimport { OrgRolePicker } from '../admin/OrgRolePicker';\n\nexport interface Props {\n  users: OrgUser[];\n  orgId?: number;\n  onRoleChange: (role: OrgRole, user: OrgUser) => void;\n  onRemoveUser: (user: OrgUser) => void;\n}\n\nconst UsersTable: FC<Props> = (props) => {\n  const { users, orgId, onRoleChange, onRemoveUser } = props;\n  const [userToRemove, setUserToRemove] = useState<OrgUser | null>(null);\n  const [roleOptions, setRoleOptions] = useState<Role[]>([]);\n\n  useEffect(() => {\n    async function fetchOptions() {\n      try {\n        if (contextSrv.hasPermission(AccessControlAction.ActionRolesList)) {\n          let options = await fetchRoleOptions(orgId);\n          setRoleOptions(options);\n        }\n      } catch (e) {\n        console.error('Error loading options');\n      }\n    }\n    if (contextSrv.licensedAccessControlEnabled()) {\n      fetchOptions();\n    }\n  }, [orgId]);\n\n  return (\n    <>\n      <table className=\"filter-table form-inline\">\n        <thead>\n          <tr>\n            <th />\n            <th>Login</th>\n            <th>Email</th>\n            <th>Name</th>\n            <th>Seen</th>\n            <th>Role</th>\n            <th style={{ width: '34px' }} />\n            <th></th>\n          </tr>\n        </thead>\n        <tbody>\n          {users.map((user, index) => {\n            return (\n              <tr key={`${user.userId}-${index}`}>\n                <td className=\"width-2 text-center\">\n                  <img className=\"filter-table__avatar\" src={user.avatarUrl} alt=\"User avatar\" />\n                </td>\n                <td className=\"max-width-6\">\n                  <span className=\"ellipsis\" title={user.login}>\n                    {user.login}\n                  </span>\n                </td>\n\n                <td className=\"max-width-5\">\n                  <span className=\"ellipsis\" title={user.email}>\n                    {user.email}\n                  </span>\n                </td>\n                <td className=\"max-width-5\">\n                  <span className=\"ellipsis\" title={user.name}>\n                    {user.name}\n                  </span>\n                </td>\n                <td className=\"width-1\">{user.lastSeenAtAge}</td>\n\n                <td className=\"width-8\">\n                  {contextSrv.licensedAccessControlEnabled() ? (\n                    <UserRolePicker\n                      userId={user.userId}\n                      orgId={orgId}\n                      roleOptions={roleOptions}\n                      basicRole={user.role}\n                      onBasicRoleChange={(newRole) => onRoleChange(newRole, user)}\n                      basicRoleDisabled={!contextSrv.hasPermissionInMetadata(AccessControlAction.OrgUsersWrite, user)}\n                    />\n                  ) : (\n                    <OrgRolePicker\n                      aria-label=\"Role\"\n                      value={user.role}\n                      disabled={!contextSrv.hasPermissionInMetadata(AccessControlAction.OrgUsersWrite, user)}\n                      onChange={(newRole) => onRoleChange(newRole, user)}\n                    />\n                  )}\n                </td>\n\n                <td className=\"width-1 text-center\">\n                  {user.isDisabled && <span className=\"label label-tag label-tag--gray\">Disabled</span>}\n                </td>\n\n                {contextSrv.hasPermissionInMetadata(AccessControlAction.OrgUsersRemove, user) && (\n                  <td className=\"text-right\">\n                    <Button\n                      size=\"sm\"\n                      variant=\"destructive\"\n                      onClick={() => {\n                        setUserToRemove(user);\n                      }}\n                      icon=\"times\"\n                      aria-label=\"Delete user\"\n                    />\n                  </td>\n                )}\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n      {Boolean(userToRemove) && (\n        <ConfirmModal\n          body={`Are you sure you want to delete user ${userToRemove?.login}?`}\n          confirmText=\"Delete\"\n          title=\"Delete\"\n          onDismiss={() => {\n            setUserToRemove(null);\n          }}\n          isOpen={true}\n          onConfirm={() => {\n            if (!userToRemove) {\n              return;\n            }\n            onRemoveUser(userToRemove);\n            setUserToRemove(null);\n          }}\n        />\n      )}\n    </>\n  );\n};\n\nexport default UsersTable;\n"],"names":["mapDispatchToProps","revokeInvite","connector","connect","InviteeRow","PureComponent","render","invitee","this","props","email","name","className","ClipboardButton","icon","variant","size","getText","url","Button","onClick","code","InviteesTable","invitees","style","width","map","index","id","selectAll","selectById","selectTotal","selectors","selectInvitesMatchingQuery","createSelector","_","query","invites","searchQuery","regex","RegExp","filter","invite","test","getUsers","state","users","user","login","getUsersSearchQuery","getUsersSearchPage","searchPage","UsersActionBar","canInvite","externalUserMngLinkName","externalUserMngLinkUrl","pendingInvitesCount","setUsersSearchQuery","onShowInvites","showInvites","options","label","value","canAddToOrg","contextSrv","AccessControlAction","FilterInput","onChange","placeholder","marginLeft","RadioButtonGroup","href","target","rel","loadUsers","async","getBackendSrv","get","accessControlQueryParam","dispatch","usersLoaded","fetchInvitees","setUsersSearchPage","updateUser","patch","userId","role","removeUser","delete","externalUserMngInfo","hasFetched","UsersListPage","constructor","super","updatedUser","setState","prevState","offset","slice","externalUserMngInfoHtml","renderMarkdown","componentDidMount","fetchUsers","renderTable","paginatedUsers","getPaginatedUsers","totalPages","Math","ceil","length","spacing","UsersTable","orgId","onRoleChange","onRemoveUser","justify","Pagination","onNavigate","currentPage","numberOfPages","hideWhenSinglePage","Page","navId","isLoading","dangerouslySetInnerHTML","__html","userToRemove","setUserToRemove","useState","roleOptions","setRoleOptions","useEffect","fetchRoleOptions","e","console","error","fetchOptions","src","avatarUrl","alt","title","lastSeenAtAge","basicRole","onBasicRoleChange","newRole","basicRoleDisabled","disabled","isDisabled","Boolean","body","confirmText","onDismiss","isOpen","onConfirm"],"sourceRoot":""}