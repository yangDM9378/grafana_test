"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[8648],{99346:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Mt});var n=a(52423),r=a(68404),i=a(16755),l=a(2843),s=a(38953),o=a(72767),c=a(64850),d=a(19200),u=a(39833),g=a(73615),m=a(62791),h=a(67921),p=a(47628),v=a(8006),x=a(60277),j=a(96535),f=a(3218),b=a(65678),y=a(35258),C=a(70917),N=a(32889),w=a(38595),I=a(4645),S=a(82897),$=a(8157),V=a(72710),T=a(43271),O=a(57938);const _=["",""],M=(e,t)=>Object.entries(null!=e?e:{}).reduce(((e,a)=>{let[n,r]=a;return[...e,{name:n,value:r,operator:t?$._M.regex:$._M.equal}]}),[]),k=(e,t)=>{if(!e)return null!=t?t:_;const[a,n]=e?(0,O.bG)(e):[void 0,void 0],r=O.qr.find((e=>e.value===n));return a&&r?[String(a),r.value]:_},A=e=>e.value,q={name:"",value:"",operator:$._M.equal},G=[{label:"grafana_folder",value:"grafana_folder"},{label:"alertname",value:"alertname"},{label:"Disable (...)",value:"..."}],P={id:"",overrideGrouping:!1,groupBy:["grafana_folder","alertname"],object_matchers:[],routes:[],continue:!1,receiver:"",overrideTimings:!1,groupWaitValue:"",groupWaitValueType:O.qr[0].value,groupIntervalValue:"",groupIntervalValueType:O.qr[0].value,repeatIntervalValue:"",repeatIntervalValueType:O.qr[0].value,muteTimeIntervals:[]},W=e=>{var t,a,n,r,i,l,s,o,c;if(!e)return[P,{}];const d=String(Math.random()),u={[d]:e};if(0===Object.keys(e).length){return[Object.assign({},P,{id:d}),u]}const g=[];null===(t=e.routes)||void 0===t||t.forEach((e=>{const[t,a]=W(e);g.push(t),Object.assign(u,a)}));const m=e.matchers?null!==(a=null===(n=e.matchers)||void 0===n?void 0:n.map((e=>(0,V.cm)((0,V.tC)(e)))))&&void 0!==a?a:[]:null!==(r=null===(i=e.object_matchers)||void 0===i?void 0:i.map((e=>({name:e[0],operator:e[1],value:e[2]}))))&&void 0!==r?r:[],[h,p]=k(e.group_wait,["","s"]),[v,x]=k(e.group_interval,["","m"]),[j,f]=k(e.repeat_interval,["","h"]);return[{id:d,object_matchers:[...m,...M(e.match,!1),...M(e.match_re,!0)],continue:null!==(l=e.continue)&&void 0!==l&&l,receiver:null!==(s=e.receiver)&&void 0!==s?s:"",overrideGrouping:Array.isArray(e.group_by)&&0!==e.group_by.length,groupBy:null!==(o=e.group_by)&&void 0!==o?o:[],overrideTimings:[h,v,j].some(Boolean),groupWaitValue:h,groupWaitValueType:p,groupIntervalValue:v,groupIntervalValueType:x,repeatIntervalValue:j,repeatIntervalValueType:f,routes:g,muteTimeIntervals:null!==(c=e.mute_time_intervals)&&void 0!==c?c:[]},u]},B=(e,t,a)=>{const n=a[t.id],{overrideGrouping:r,groupBy:i,overrideTimings:l,groupWaitValue:s,groupWaitValueType:o,groupIntervalValue:c,groupIntervalValueType:d,repeatIntervalValue:u,repeatIntervalValueType:g}=t,m=r&&i?i:[],h=l&&s?`${s}${o}`:void 0,p=l&&c?`${c}${d}`:void 0,v=l&&u?`${u}${g}`:void 0,x=Object.assign({},null!=n?n:{},{continue:t.continue,group_by:m,object_matchers:t.object_matchers.length?t.object_matchers.map((e=>[e.name,e.operator,e.value])):void 0,match:void 0,match_re:void 0,group_wait:h,group_interval:p,repeat_interval:v,routes:t.routes.map((t=>B(e,t,a))),mute_time_intervals:t.muteTimeIntervals});return e!==T.GC?(x.matchers=t.object_matchers.map((e=>{let{name:t,operator:a,value:n}=e;return`${t}${a}${n}`})),x.object_matchers=void 0):x.matchers=void 0,t.receiver&&(x.receiver=t.receiver),(0,S.omitBy)(x,S.isUndefined)},E=e=>({label:e,value:e}),z=e=>(null!=e?e:[]).map(E),F=e=>{var t;return e&&null!==(t=A(e))&&void 0!==t?t:""},R=e=>{return e?(null!=(t=e)?t:[]).map(A):[];var t},D=e=>{if(e)return/^\d+$/.test(e)?void 0:"Must be a positive integer."};var L=a(23691);const J=e=>({container:n.css`
      align-items: center;
      display: flex;
      flex-flow: row nowrap;

      & > * + * {
        margin-left: ${e.spacing(1)};
      }
    `,input:n.css`
      flex: 1;
    `,timingContainer:n.css`
      max-width: ${e.spacing(33)};
    `,smallInput:n.css`
      width: ${e.spacing(6.5)};
    `,linkText:n.css`
      text-decoration: underline;
    `,collapse:n.css`
      border: none;
      background: none;
      color: ${e.colors.text.primary};
    `});var Q,U,K=a(45916);const Y=["onChange","ref"],Z=["onChange","ref"],H=["onChange","ref"],X=["onChange","ref"],ee=["onChange","ref"];function te(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}const ae=e=>{var t;let{alertManagerSourceName:a,onCancel:l,onSave:s,receivers:o,routes:c}=e;const d=(0,i.wW)(J),[u,g]=(0,r.useState)(!1),[m,h]=(0,r.useState)(z(c.groupBy));return(0,K.jsx)(f.l,{defaultValues:Object.assign({},c,{overrideTimings:!0,overrideGrouping:!0}),onSubmit:s,children:e=>{var r,i,s,c;let{control:p,errors:x,setValue:j}=e;return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(b.g,{label:"Default contact point",invalid:!!x.receiver,error:null===(r=x.receiver)||void 0===r?void 0:r.message,children:(0,K.jsx)(K.Fragment,{children:(0,K.jsxs)("div",{className:d.container,"data-testid":"am-receiver-select",children:[(0,K.jsx)(y.g,{render:e=>{let{field:{onChange:t}}=e,a=te(e.field,Y);return(0,K.jsx)(C.Ph,Object.assign({"aria-label":"Default contact point"},a,{className:d.input,onChange:e=>t(F(e)),options:o}))},control:p,name:"receiver",rules:{required:{value:!0,message:"Required."}}}),Q||(Q=(0,K.jsx)("span",{children:"or"})),(0,K.jsx)(N.r,{className:d.linkText,href:(0,L.eQ)("/alerting/notifications/receivers/new",a),children:"Create a contact point"})]})})}),(0,K.jsx)(b.g,{label:"Group by",description:"Group alerts when you receive a notification based on labels.","data-testid":"am-group-select",children:(0,K.jsx)(y.g,{render:e=>{let{field:{onChange:t}}=e,a=te(e.field,Z);return(0,K.jsx)(C.NU,Object.assign({"aria-label":"Group by"},a,{allowCustomValue:!0,className:d.input,onCreateOption:e=>{h((t=>[...t,E(e)])),j("groupBy",[...a.value,e])},onChange:e=>t(R(e)),options:[...G,...m]}))},control:p,name:"groupBy"})}),(0,K.jsxs)(w.U,{collapsible:!0,className:d.collapse,isOpen:u,label:"Timing options",onToggle:g,children:[(0,K.jsx)(b.g,{label:"Group wait",description:"The waiting time until the initial notification is sent for a new group created by an incoming alert. Default 30 seconds.",invalid:!!x.groupWaitValue,error:null===(i=x.groupWaitValue)||void 0===i?void 0:i.message,"data-testid":"am-group-wait",children:(0,K.jsx)(K.Fragment,{children:(0,K.jsxs)("div",{className:(0,n.cx)(d.container,d.timingContainer),children:[(0,K.jsx)(y.g,{render:e=>{let{field:t,fieldState:{invalid:a}}=e;return(0,K.jsx)(I.I,Object.assign({},t,{className:d.smallInput,invalid:a,placeholder:"30"}))},control:p,name:"groupWaitValue",rules:{validate:D}}),(0,K.jsx)(y.g,{render:e=>{let{field:{onChange:t}}=e,a=te(e.field,H);return(0,K.jsx)(C.Ph,Object.assign({},a,{className:d.input,onChange:e=>t(F(e)),options:O.qr,"aria-label":"Group wait type"}))},control:p,name:"groupWaitValueType"})]})})}),(0,K.jsx)(b.g,{label:"Group interval",description:"The waiting time to send a batch of new alerts for that group after the first notification was sent. Default 5 minutes.",invalid:!!x.groupIntervalValue,error:null===(s=x.groupIntervalValue)||void 0===s?void 0:s.message,"data-testid":"am-group-interval",children:(0,K.jsx)(K.Fragment,{children:(0,K.jsxs)("div",{className:(0,n.cx)(d.container,d.timingContainer),children:[(0,K.jsx)(y.g,{render:e=>{let{field:t,fieldState:{invalid:a}}=e;return(0,K.jsx)(I.I,Object.assign({},t,{className:d.smallInput,invalid:a,placeholder:"5"}))},control:p,name:"groupIntervalValue",rules:{validate:D}}),(0,K.jsx)(y.g,{render:e=>{let{field:{onChange:t}}=e,a=te(e.field,X);return(0,K.jsx)(C.Ph,Object.assign({},a,{className:d.input,onChange:e=>t(F(e)),options:O.qr,"aria-label":"Group interval type"}))},control:p,name:"groupIntervalValueType"})]})})}),(0,K.jsx)(b.g,{label:"Repeat interval",description:"The waiting time to resend an alert after they have successfully been sent. Default 4 hours.",invalid:!!x.repeatIntervalValue,error:null===(c=x.repeatIntervalValue)||void 0===c?void 0:c.message,"data-testid":"am-repeat-interval",children:(0,K.jsx)(K.Fragment,{children:(0,K.jsxs)("div",{className:(0,n.cx)(d.container,d.timingContainer),children:[(0,K.jsx)(y.g,{render:e=>{let{field:t,fieldState:{invalid:a}}=e;return(0,K.jsx)(I.I,Object.assign({},t,{className:d.smallInput,invalid:a,placeholder:"4"}))},control:p,name:"repeatIntervalValue",rules:{validate:D}}),(0,K.jsx)(y.g,{render:e=>{let{field:{onChange:t}}=e,a=te(e.field,ee);return(0,K.jsx)(C.Ph,Object.assign({},a,{className:d.input,menuPlacement:"top",onChange:e=>t(F(e)),options:O.qr,"aria-label":"Repeat interval type"}))},control:p,name:"repeatIntervalValueType"})]})})})]}),(0,K.jsxs)("div",{className:d.container,children:[U||(U=(0,K.jsx)(v.zx,{type:"submit",children:"Save"})),t||(t=(0,K.jsx)(v.zx,{onClick:l,type:"reset",variant:"secondary",fill:"outline",children:"Cancel"}))]})]})}})},ne=e=>({container:n.css`
      display: grid;
      font-style: ${e.typography.fontSize};
      grid-template-columns: ${e.spacing(15.5)} auto;

      ${e.breakpoints.down("md")} {
        grid-template-columns: 100%;
      }
    `,titleCell:n.css`
      color: ${e.colors.text.primary};
    `,valueCell:n.css`
      color: ${e.colors.text.secondary};
      margin-bottom: ${e.spacing(1)};
    `}),re=e=>{let{routes:t}=e;const a=(0,i.wW)(ne),n=t.receiver||"-",r=t.groupBy.join(", ")||"-",l=t.groupWaitValue?`${t.groupWaitValue}${t.groupWaitValueType}`:"-",s=t.groupIntervalValue?`${t.groupIntervalValue}${t.groupIntervalValueType}`:"-",o=t.repeatIntervalValue?`${t.repeatIntervalValue}${t.repeatIntervalValueType}`:"-";return(0,K.jsxs)("div",{className:a.container,children:[(0,K.jsx)("div",{className:a.titleCell,children:"Contact point"}),(0,K.jsx)("div",{className:a.valueCell,"data-testid":"am-routes-root-receiver",children:n}),(0,K.jsx)("div",{className:a.titleCell,children:"Group by"}),(0,K.jsx)("div",{className:a.valueCell,"data-testid":"am-routes-root-group-by",children:r}),(0,K.jsx)("div",{className:a.titleCell,children:"Timings"}),(0,K.jsxs)("div",{className:a.valueCell,"data-testid":"am-routes-root-timings",children:["Group wait: ",l," | Group interval: ",s," | Repeat interval: ",o]})]})};var ie,le;const se=e=>{let{isEditMode:t,onSave:a,onEnterEditMode:n,onExitEditMode:r,receivers:l,routes:s,alertManagerSourceName:o,readOnly:c=!1}=e;const d=(0,i.wW)(oe),u=(0,j.Ko)(o);return(0,K.jsxs)("div",{className:d.container,"data-testid":"am-root-route-container",children:[(0,K.jsxs)("div",{className:d.titleContainer,children:[(0,K.jsxs)("h5",{className:d.title,children:["Root policy - ",ie||(ie=(0,K.jsx)("i",{children:"default for all alerts"}))]}),!t&&!c&&(0,K.jsx)(x.q,{actions:[u.update],children:(0,K.jsx)(v.zx,{icon:"pen",onClick:n,size:"sm",type:"button",variant:"secondary",children:"Edit"})})]}),le||(le=(0,K.jsx)("p",{children:"All alerts will go to the default contact point, unless you set additional matchers in the specific routing area."})),t?(0,K.jsx)(ae,{alertManagerSourceName:o,onCancel:r,onSave:a,receivers:l,routes:s}):(0,K.jsx)(re,{routes:s})]})},oe=e=>({container:n.css`
      background-color: ${e.colors.background.secondary};
      color: ${e.colors.text.secondary};
      padding: ${e.spacing(2)};
    `,titleContainer:n.css`
      color: ${e.colors.text.primary};
      display: flex;
      flex-flow: row nowrap;
    `,title:n.css`
      flex: 100%;
    `});var ce=a(94255),de=a(83744),ue=a(99500),ge=a(59196),me=a(34426);const he=e=>{let{children:t}=e;const a=(0,i.wW)(pe);return(0,K.jsx)("div",{className:a.container,children:t})},pe=e=>({container:n.css`
      background-color: ${e.colors.background.secondary};
      color: ${e.colors.text.secondary};
      padding: ${e.spacing(4)};
      text-align: center;
    `}),ve=e=>{let{buttonIcon:t,buttonLabel:a,buttonSize:n="lg",buttonVariant:r="primary",onButtonClick:l,text:s,href:o,showButton:c=!0}=e;const d=(0,i.wW)(xe),u={className:d.button,icon:t,size:n,variant:r};return(0,K.jsx)(he,{children:(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("p",{className:d.text,children:s}),c&&(o?(0,K.jsx)(v.Qj,Object.assign({href:o,type:"button"},u,{children:a})):(0,K.jsx)(v.zx,Object.assign({onClick:l,type:"button"},u,{children:a})))]})})},xe=e=>({container:n.css`
      background-color: ${e.colors.background.secondary};
      color: ${e.colors.text.secondary};
      padding: ${e.spacing(4)};
      text-align: center;
    `,text:n.css`
      margin-bottom: ${e.spacing(2)};
    `,button:n.css`
      margin: ${e.spacing(2,0,1)};
    `});var je=a(54761),fe=a(23734),be=a(2024);var ye=a(39440),Ce=a(74562),Ne=a(68455),we=a(64313),Ie=a(70800),Se=a(5302),$e=a(69066),Ve=a(46150),Te=a(76938);const Oe=["onChange","ref"],_e=["onChange","ref"],Me=["onChange","ref"],ke=["onChange","ref"],Ae=["onChange","ref"],qe=["onChange","ref"],Ge=["onChange","ref"];var Pe,We;function Be(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}const Ee=e=>{var t;let{onCancel:a,onSave:l,receivers:s,routes:o}=e;const c=(0,i.wW)(ze),d=(0,i.wW)(J),[u,g]=(0,r.useState)(z(o.groupBy)),m=function(){const e=(0,Ve.k)("notification"),[t]=(0,$e.k)(e),a=(0,Te._)((e=>e.amConfigs));return(0,r.useMemo)((()=>{var e,n,r;const{result:i}=t&&a[t]||Se.oq,l=null!==(e=null==i?void 0:i.alertmanager_config)&&void 0!==e?e:{};return null!==(n=null==l||null===(r=l.mute_time_intervals)||void 0===r?void 0:r.map((e=>({value:e.name,label:e.name,description:e.time_intervals.map((e=>(0,V.uK)(e))).join(", AND ")}))))&&void 0!==n?n:[]}),[t,a])}();return(0,K.jsx)(f.l,{defaultValues:o,onSubmit:l,children:e=>{var r,i,l;let{control:o,register:h,errors:p,setValue:x,watch:j}=e;return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("input",Object.assign({type:"hidden"},h("id"))),(0,K.jsx)(Ne.F,{name:"object_matchers",control:o,children:e=>{let{fields:t,append:a,remove:n}=e;return(0,K.jsx)(K.Fragment,{children:(0,K.jsxs)(je.wc,{justify:"flex-start",spacing:"md",children:[Pe||(Pe=(0,K.jsx)("div",{children:"Matching labels"})),0===t.length&&(0,K.jsx)(we.C,{color:"orange",className:c.noMatchersWarning,icon:"exclamation-triangle",text:"If no matchers are specified, this notification policy will handle all alert instances."}),t.length>0&&(0,K.jsx)("div",{className:c.matchersContainer,children:t.map(((e,t)=>{var a,r,i,l,s,d,u,g,m,v;const x=`object_matchers[${t}]`;return(0,K.jsxs)(je.Lh,{align:"flex-start",height:"auto",children:[(0,K.jsx)(b.g,{label:"Label",invalid:!(null===(a=p.object_matchers)||void 0===a||null===(r=a[t])||void 0===r||!r.name),error:null===(i=p.object_matchers)||void 0===i||null===(l=i[t])||void 0===l||null===(s=l.name)||void 0===s?void 0:s.message,children:(0,K.jsx)(I.I,Object.assign({},h(`${x}.name`,{required:"Field is required"}),{defaultValue:e.name,placeholder:"label"}))}),(0,K.jsx)(b.g,{label:"Operator",children:(0,K.jsx)(y.g,{render:e=>{let{field:{onChange:t}}=e,a=Be(e.field,Oe);return(0,K.jsx)(C.Ph,Object.assign({},a,{className:c.matchersOperator,onChange:e=>t(null==e?void 0:e.value),options:V.tA,"aria-label":"Operator"}))},defaultValue:e.operator,control:o,name:`${x}.operator`,rules:{required:{value:!0,message:"Required."}}})}),(0,K.jsx)(b.g,{label:"Value",invalid:!(null===(d=p.object_matchers)||void 0===d||null===(u=d[t])||void 0===u||!u.value),error:null===(g=p.object_matchers)||void 0===g||null===(m=g[t])||void 0===m||null===(v=m.value)||void 0===v?void 0:v.message,children:(0,K.jsx)(I.I,Object.assign({},h(`${x}.value`,{required:"Field is required"}),{defaultValue:e.value,placeholder:"value"}))}),(0,K.jsx)(fe.h,{className:c.removeButton,tooltip:"Remove matcher",name:"trash-alt",onClick:()=>n(t),children:"Remove"})]},e.id)}))}),(0,K.jsx)(v.zx,{className:c.addMatcherBtn,icon:"plus",onClick:()=>a(q),variant:"secondary",type:"button",children:"Add matcher"})]})})}}),(0,K.jsx)(b.g,{label:"Contact point",children:(0,K.jsx)(y.g,{render:e=>{let{field:{onChange:t}}=e,a=Be(e.field,_e);return(0,K.jsx)(C.Ph,Object.assign({"aria-label":"Contact point"},a,{className:d.input,onChange:e=>t(F(e)),options:s}))},control:o,name:"receiver"})}),(0,K.jsx)(b.g,{label:"Continue matching subsequent sibling nodes",children:(0,K.jsx)(Ie.r,Object.assign({id:"continue-toggle"},h("continue")))}),(0,K.jsx)(b.g,{label:"Override grouping",children:(0,K.jsx)(Ie.r,Object.assign({id:"override-grouping-toggle"},h("overrideGrouping")))}),j().overrideGrouping&&(0,K.jsx)(b.g,{label:"Group by",description:"Group alerts when you receive a notification based on labels. If empty it will be inherited from the parent policy.",children:(0,K.jsx)(y.g,{render:e=>{let{field:{onChange:t}}=e,a=Be(e.field,Me);return(0,K.jsx)(C.NU,Object.assign({"aria-label":"Group by"},a,{allowCustomValue:!0,className:d.input,onCreateOption:e=>{g((t=>[...t,E(e)])),x("groupBy",[...a.value,e])},onChange:e=>t(R(e)),options:[...G,...u]}))},control:o,name:"groupBy"})}),(0,K.jsx)(b.g,{label:"Override general timings",children:(0,K.jsx)(Ie.r,Object.assign({id:"override-timings-toggle"},h("overrideTimings")))}),j().overrideTimings&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(b.g,{label:"Group wait",description:"The waiting time until the initial notification is sent for a new group created by an incoming alert. If empty it will be inherited from the parent policy.",invalid:!!p.groupWaitValue,error:null===(r=p.groupWaitValue)||void 0===r?void 0:r.message,children:(0,K.jsx)(K.Fragment,{children:(0,K.jsxs)("div",{className:(0,n.cx)(d.container,d.timingContainer),children:[(0,K.jsx)(y.g,{render:e=>{let{field:t,fieldState:{invalid:a}}=e;return(0,K.jsx)(I.I,Object.assign({},t,{className:d.smallInput,invalid:a,"aria-label":"Group wait value"}))},control:o,name:"groupWaitValue",rules:{validate:D}}),(0,K.jsx)(y.g,{render:e=>{let{field:{onChange:t}}=e,a=Be(e.field,ke);return(0,K.jsx)(C.Ph,Object.assign({},a,{className:d.input,onChange:e=>t(F(e)),options:O.qr,"aria-label":"Group wait type"}))},control:o,name:"groupWaitValueType"})]})})}),(0,K.jsx)(b.g,{label:"Group interval",description:"The waiting time to send a batch of new alerts for that group after the first notification was sent. If empty it will be inherited from the parent policy.",invalid:!!p.groupIntervalValue,error:null===(i=p.groupIntervalValue)||void 0===i?void 0:i.message,children:(0,K.jsx)(K.Fragment,{children:(0,K.jsxs)("div",{className:(0,n.cx)(d.container,d.timingContainer),children:[(0,K.jsx)(y.g,{render:e=>{let{field:t,fieldState:{invalid:a}}=e;return(0,K.jsx)(I.I,Object.assign({},t,{className:d.smallInput,invalid:a,"aria-label":"Group interval value"}))},control:o,name:"groupIntervalValue",rules:{validate:D}}),(0,K.jsx)(y.g,{render:e=>{let{field:{onChange:t}}=e,a=Be(e.field,Ae);return(0,K.jsx)(C.Ph,Object.assign({},a,{className:d.input,onChange:e=>t(F(e)),options:O.qr,"aria-label":"Group interval type"}))},control:o,name:"groupIntervalValueType"})]})})}),(0,K.jsx)(b.g,{label:"Repeat interval",description:"The waiting time to resend an alert after they have successfully been sent.",invalid:!!p.repeatIntervalValue,error:null===(l=p.repeatIntervalValue)||void 0===l?void 0:l.message,children:(0,K.jsx)(K.Fragment,{children:(0,K.jsxs)("div",{className:(0,n.cx)(d.container,d.timingContainer),children:[(0,K.jsx)(y.g,{render:e=>{let{field:t,fieldState:{invalid:a}}=e;return(0,K.jsx)(I.I,Object.assign({},t,{className:d.smallInput,invalid:a,"aria-label":"Repeat interval value"}))},control:o,name:"repeatIntervalValue",rules:{validate:D}}),(0,K.jsx)(y.g,{render:e=>{let{field:{onChange:t}}=e,a=Be(e.field,qe);return(0,K.jsx)(C.Ph,Object.assign({},a,{className:d.input,menuPlacement:"top",onChange:e=>t(F(e)),options:O.qr,"aria-label":"Repeat interval type"}))},control:o,name:"repeatIntervalValueType"})]})})})]}),(0,K.jsx)(b.g,{label:"Mute timings","data-testid":"am-mute-timing-select",description:"Add mute timing to policy",invalid:!!p.muteTimeIntervals,children:(0,K.jsx)(y.g,{render:e=>{let{field:{onChange:t}}=e,a=Be(e.field,Ge);return(0,K.jsx)(C.NU,Object.assign({"aria-label":"Mute timings"},a,{className:d.input,onChange:e=>t(R(e)),options:m}))},control:o,name:"muteTimeIntervals"})}),(0,K.jsxs)("div",{className:c.buttonGroup,children:[We||(We=(0,K.jsx)(v.zx,{type:"submit",children:"Save policy"})),t||(t=(0,K.jsx)(v.zx,{onClick:a,fill:"outline",type:"button",variant:"secondary",children:"Cancel"}))]})]})}})},ze=e=>{const t=e.spacing(3.5);return{addMatcherBtn:n.css`
      margin-bottom: ${t};
    `,matchersContainer:n.css`
      background-color: ${e.colors.background.secondary};
      margin: ${e.spacing(1,0)};
      padding: ${e.spacing(1,4.6,1,1.5)};
      width: fit-content;
    `,matchersOperator:n.css`
      min-width: 140px;
    `,nestedPolicies:n.css`
      margin-top: ${t};
    `,removeButton:n.css`
      margin-left: ${e.spacing(1)};
      margin-top: ${e.spacing(2.5)};
    `,buttonGroup:n.css`
      margin: ${e.spacing(6)} 0 ${t};

      & > * + * {
        margin-left: ${e.spacing(1.5)};
      }
    `,noMatchersWarning:n.css`
      padding: ${e.spacing(1)} ${e.spacing(2)};
    `}};var Fe,Re,De,Le,Je,Qe,Ue,Ke,Ye=a(64834);const Ze=e=>{var t,a;let{alertManagerSourceName:n,muteTimingNames:l,hideActions:s}=e;const o=(0,i.wW)(Xe),d=(0,c.I0)(),u=(0,j.Ko)(n),g=(0,Te._)((e=>e.amConfigs)),[m,h]=(0,r.useState)(""),{result:f}=n&&g[n]||Se.oq,b=(0,r.useMemo)((()=>{var e,t,a,n;const r=null!==(e=null==f||null===(t=f.alertmanager_config)||void 0===t?void 0:t.mute_time_intervals)&&void 0!==e?e:[],i=null!==(a=null==f||null===(n=f.alertmanager_config)||void 0===n?void 0:n.muteTimeProvenances)&&void 0!==a?a:{};return r.filter((e=>{let{name:t}=e;return!l||l.includes(t)})).map((e=>({id:e.name,data:Object.assign({},e,{provenance:i[e.name]})})))}),[null==f||null===(t=f.alertmanager_config)||void 0===t?void 0:t.mute_time_intervals,null==f||null===(a=f.alertmanager_config)||void 0===a?void 0:a.muteTimeProvenances,l]),y=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;const n=(0,j.Ko)(e),i=ge.Vt.hasPermission(n.update),l=ge.Vt.hasPermission(n.delete),s=!t&&(i||l);return(0,r.useMemo)((()=>{const t=[{id:"name",label:"Name",renderCell:function(e){let{data:t}=e;return(0,K.jsxs)(K.Fragment,{children:[t.name," ",t.provenance&&(Le||(Le=(0,K.jsx)(p.C0,{})))]})},size:"250px"},{id:"timeRange",label:"Time range",renderCell:e=>{let{data:t}=e;return He(t.time_intervals)}}];return s&&t.push({id:"actions",label:"Actions",renderCell:function(t){let{data:r}=t;return r.provenance?(0,K.jsx)("div",{children:(0,K.jsx)(N.r,{href:(0,L.eQ)("/alerting/routes/mute-timing/edit",e,{muteName:r.name}),children:Je||(Je=(0,K.jsx)(fe.h,{name:"file-alt",title:"View mute timing"}))})}):(0,K.jsxs)("div",{children:[(0,K.jsx)(x.q,{actions:[n.update],children:(0,K.jsx)(N.r,{href:(0,L.eQ)("/alerting/routes/mute-timing/edit",e,{muteName:r.name}),children:Qe||(Qe=(0,K.jsx)(fe.h,{name:"edit",title:"Edit mute timing"}))})}),(0,K.jsx)(x.q,{actions:[n.delete],children:(0,K.jsx)(fe.h,{name:"trash-alt",title:"Delete mute timing",onClick:()=>a(r.name)})})]})},size:"100px"}),t}),[e,a,s,n])}(n,s,h);return(0,K.jsxs)("div",{className:o.container,children:[!s&&(Fe||(Fe=(0,K.jsx)("h5",{children:"Mute timings"}))),!s&&(Re||(Re=(0,K.jsx)("p",{children:"Mute timings are a named interval of time that may be referenced in the notification policy tree to mute particular notification policies for specific times of the day."}))),!s&&b.length>0&&(0,K.jsx)(x.q,{actions:[u.create],children:(0,K.jsx)(v.Qj,{className:o.addMuteButton,icon:"plus",variant:"primary",href:(0,L.eQ)("alerting/routes/mute-timing/new",n),children:"New mute timing"})}),b.length>0?(0,K.jsx)(ye.t,{items:b,cols:y}):s?De||(De=(0,K.jsx)("p",{children:"No mute timings configured"})):(0,K.jsx)(ve,{text:"You haven't created any mute timings yet",buttonLabel:"Add mute timing",buttonIcon:"plus",buttonSize:"lg",href:(0,L.eQ)("alerting/routes/mute-timing/new",n),showButton:ge.Vt.hasPermission(u.create)}),!s&&(0,K.jsx)(be.s,{isOpen:!!m,title:"Delete mute timing",body:`Are you sure you would like to delete "${m}"`,confirmText:"Delete",onConfirm:()=>d((0,Ye.r0)(n,m)),onDismiss:()=>h("")})]})};function He(e){return e.map(((e,t)=>{const{times:a,weekdays:n,days_of_month:i,months:l,years:s}=e,o=(0,V.u6)(a),c=(0,V.v7)(n),d=(0,V.J8)(i),u=(0,V.m8)(l),g=(0,V.qw)(s);return(0,K.jsxs)(r.Fragment,{children:[`${o} ${c}`,Ue||(Ue=(0,K.jsx)("br",{})),[d,u,g].join(" | "),Ke||(Ke=(0,K.jsx)("br",{}))]},JSON.stringify(e)+t)}))}const Xe=e=>({container:n.css`
    display: flex;
    flex-flow: column nowrap;
  `,addMuteButton:n.css`
    margin-bottom: ${e.spacing(2)};
    align-self: flex-end;
  `});var et;const tt=e=>{let{onChange:t,receivers:a,routes:n,readOnly:l=!1,alertManagerSourceName:s}=e;const o=(0,i.wW)(at),c=(0,i.wW)(ne),d=(0,j.Ko)(s),u=n.groupWaitValue?`${n.groupWaitValue}${n.groupWaitValueType}`:"-",g=n.groupIntervalValue?`${n.groupIntervalValue}${n.groupIntervalValueType}`:"-",m=n.repeatIntervalValue?`${n.repeatIntervalValue}${n.repeatIntervalValueType}`:"-",[h,p]=(0,r.useState)(n.routes),[f,b]=(0,r.useState)(!1);return(0,K.jsxs)("div",{className:c.container,children:[(0,K.jsx)("div",{className:c.titleCell,children:"Group wait"}),(0,K.jsx)("div",{className:c.valueCell,children:u}),(0,K.jsx)("div",{className:c.titleCell,children:"Group interval"}),(0,K.jsx)("div",{className:c.valueCell,children:g}),(0,K.jsx)("div",{className:c.titleCell,children:"Repeat interval"}),(0,K.jsx)("div",{className:c.valueCell,children:m}),(0,K.jsx)("div",{className:c.titleCell,children:"Nested policies"}),(0,K.jsxs)("div",{className:c.valueCell,children:[h.length?(0,K.jsx)(lt,{isAddMode:f,onCancelAdd:()=>{b(!1),p((e=>{const t=[...e];return t.pop(),t}))},onChange:e=>{t(Object.assign({},n,{routes:e})),f&&b(!1)},receivers:a,routes:h,alertManagerSourceName:s}):et||(et=(0,K.jsx)("p",{children:"No nested policies configured."})),!f&&!l&&(0,K.jsx)(x.q,{actions:[d.create],children:(0,K.jsx)(v.zx,{className:o.addNestedRoutingBtn,icon:"plus",onClick:()=>{p((e=>[...e,P])),b(!0)},variant:"secondary",type:"button",children:"Add nested policy"})})]}),(0,K.jsx)("div",{className:c.titleCell,children:"Mute timings"}),(0,K.jsx)("div",{className:c.valueCell,children:(0,K.jsx)(Ze,{alertManagerSourceName:s,muteTimingNames:n.muteTimeIntervals,hideActions:!0})})]})},at=e=>({addNestedRoutingBtn:n.css`
      margin-top: ${e.spacing(2)};
    `});var nt,rt;const it=(e,t)=>{const a=[...e],n=a.findIndex((e=>e.id===t.id));return n>=0&&(a[n]=Object.assign({},a[n],t)),a},lt=e=>{let{isAddMode:t,onCancelAdd:a,onChange:n,receivers:i,routes:l,filters:s,readOnly:o=!1,alertManagerSourceName:c}=e;const[d,u]=(0,r.useState)(!1),[g,m]=(0,r.useState)(void 0),[h,p]=(0,r.useState)(),x=(0,j.Ko)(c),f=ge.Vt.hasPermission(x.update),b=ge.Vt.hasPermission(x.delete),y=!o&&(f||b),C=(0,r.useCallback)((e=>p(e.id)),[]),N=(0,r.useCallback)((()=>p(void 0)),[]),w=[{id:"matchingCriteria",label:"Matching labels",renderCell:e=>e.data.object_matchers.length?(0,K.jsx)(Ce.g,{matchers:e.data.object_matchers.map(V._J)}):nt||(nt=(0,K.jsx)("span",{children:"Matches all alert instances"})),size:10},{id:"groupBy",label:"Group by",renderCell:e=>e.data.overrideGrouping&&e.data.groupBy.join(", ")||"-",size:5},{id:"receiverChannel",label:"Contact point",renderCell:e=>e.data.receiver||"-",size:5},{id:"muteTimings",label:"Mute timings",renderCell:e=>e.data.muteTimeIntervals.join(", ")||"-",size:5},...y?[{id:"actions",label:"Actions",renderCell:e=>{if(e.renderExpandedContent)return null;return(0,K.jsx)(K.Fragment,{children:(0,K.jsxs)(je.Lh,{children:[(0,K.jsx)(v.zx,{"aria-label":"Edit route",icon:"pen",onClick:()=>{C(e),u(!0)},size:"sm",type:"button",variant:"secondary",children:"Edit"}),(0,K.jsx)(fe.h,{"aria-label":"Delete route",name:"trash-alt",onClick:()=>{m(e.data.id)},type:"button"})]})})},size:"100px"}]:[]],I=(0,r.useMemo)((()=>((e,t,a)=>{const n=(0,V.Zh)(null!=t?t:"");let r=e;return n.length&&(r=e.filter((e=>{const t=e.object_matchers.map(V._J);return 0===(0,S.differenceWith)(n,t,S.isEqual).length}))),a&&a.length>0&&(r=r.filter((e=>e.receiver.toLowerCase().includes(a.toLowerCase())))),r})(l,null==s?void 0:s.queryString,null==s?void 0:s.contactPoint)),[l,s]),$=(0,r.useMemo)((()=>{return(t?l:I).map(((t,a)=>{var n;return{id:null!==(n=null==e?void 0:e(t))&&void 0!==n?n:a,data:t}}));var e}),[t,l,I]);return(0,r.useEffect)((()=>{t&&$.length&&p($[$.length-1].id),!t&&$.length&&p(void 0)}),[t,$]),l.length>0&&0===I.length?rt||(rt=(0,K.jsx)(he,{children:(0,K.jsx)("p",{children:"No policies found"})})):(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(ye.t,{cols:w,isExpandable:!0,items:$,testIdGenerator:()=>"am-routes-row",onCollapse:N,onExpand:C,isExpanded:e=>h===e.id,renderExpandedContent:e=>t||d?(0,K.jsx)(Ee,{onCancel:()=>{t&&a(),u(!1)},onSave:e=>{const t=it(l,e);u(!1),n(t)},receivers:i,routes:e.data}):(0,K.jsx)(tt,{onChange:e=>{const t=it(l,e);n(t)},receivers:i,routes:e.data,readOnly:o,alertManagerSourceName:c})}),(0,K.jsx)(be.s,{isOpen:!!g,title:"Delete notification policy",body:"Deleting this notification policy will permanently remove it. Are you sure you want to delete this policy?",confirmText:"Yes, delete",icon:"exclamation-triangle",onConfirm:()=>{if(g){const e=((e,t)=>e.filter((e=>e.id!==t)))(l,g);n(e),m(void 0)}},onDismiss:()=>m(void 0)})]})};var st,ot,ct,dt,ut,gt,mt,ht,pt,vt,xt=a(68522),jt=a(93250),ft=a(40833),bt=a(75928);const yt=e=>{let{className:t,onFilterChange:a,defaultQueryString:n}=e;const l=(0,i.wW)(Ct),s=(0,r.useMemo)((()=>(0,S.debounce)((e=>{(0,jt.PN)(ft.z7.filterPoliciesByMatchers),a(e.target.value)}),600)),[a]);(0,r.useEffect)((()=>s.cancel()),[s]);const o=st||(st=(0,K.jsx)(ue.J,{name:"search"}));return(0,K.jsxs)("div",{className:t,children:[(0,K.jsx)(de._,{children:(0,K.jsxs)(xt.Stack,{gap:.5,children:[ot||(ot=(0,K.jsx)("span",{children:"Search by matcher"})),(0,K.jsx)(bt.z,{content:(0,K.jsxs)("div",{className:l.hoverContent,children:["Filter notification policies by ",(0,K.jsx)("span",{className:l.bold,children:"matchers"}),(0,K.jsxs)("div",{className:l.textBlock,children:["Notification policies are characterized by labels matchers rathen than labels. ",ct||(ct=(0,K.jsx)("br",{})),"Filtering by matchers means we compare if matchers are equal contrary to checking if a label matches a matcher."]}),(0,K.jsxs)("div",{className:l.textBlock,children:["According to that, e.g. ",dt||(dt=(0,K.jsx)("code",{children:"severity=critical"}))," equals only ",ut||(ut=(0,K.jsx)("code",{children:"severity=critical"})),gt||(gt=(0,K.jsx)("br",{})),"and ",(0,K.jsx)("span",{className:l.bold,children:"is not equal"})," ",mt||(mt=(0,K.jsx)("code",{children:"severity=~critical"})),ht||(ht=(0,K.jsx)("br",{})),"This is an important distinction from how filtering of alert rules works"]}),pt||(pt=(0,K.jsx)("hr",{})),"Filter policies using matchers querying, e.g.:",vt||(vt=(0,K.jsx)("pre",{children:'{severity="critical", instance=~"cluster-us-.+"}'}))]}),children:(0,K.jsx)(ue.J,{className:l.icon,name:"info-circle",size:"sm"})})]})}),(0,K.jsx)(I.I,{placeholder:"Search",defaultValue:n,onChange:s,"data-testid":"search-query-input",prefix:o,className:l.inputWidth})]})},Ct=e=>({icon:n.css`
    margin-right: ${e.spacing(.5)};
  `,inputWidth:n.css`
    width: 340px;
    flex-grow: 0;
  `,bold:n.css`
    font-weight: ${e.typography.fontWeightBold};
  `,textBlock:n.css`
    padding: ${e.spacing(1,0)};
  `,hoverContent:n.css`
    max-width: 600px;
  `});var Nt,wt,It,St,$t,Vt;const Tt=e=>{var t,a;let{alertManagerSourceName:n,onChange:l,onRootRouteEdit:s,receivers:o,routes:c,readOnly:d=!1}=e;const[u,g]=(0,r.useState)([...c.routes]),[m,h]=(0,r.useState)(!1),p=(0,j.Ko)(n),f=ge.Vt.hasPermission(p.create),[b,y]=(0,me.j)(),{queryString:C,contactPoint:N}=(0,L.$f)(b),[w,S]=(0,r.useState)({queryString:C,contactPoint:N});(0,ce.Z)((()=>{y({queryString:w.queryString,contactPoint:w.contactPoint})}),400,[w]);const $=(0,i.wW)(Ot),V=()=>{S({queryString:void 0,contactPoint:void 0}),y({queryString:void 0,contactPoint:void 0})},T=()=>{V(),h(!0),g((()=>[...c.routes,Object.assign({},P,{matchers:[q]})]))};return(0,K.jsxs)("div",{className:$.container,children:[Nt||(Nt=(0,K.jsx)("h5",{children:"Specific routing"})),wt||(wt=(0,K.jsx)("p",{children:"Send specific alerts to chosen contact points, based on matching criteria"})),c.receiver?u.length>0?(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)("div",{children:[!m&&(0,K.jsxs)("div",{className:$.searchContainer,children:[(0,K.jsx)(yt,{onFilterChange:e=>S((t=>Object.assign({},t,{queryString:e}))),defaultQueryString:null!==(t=w.queryString)&&void 0!==t?t:"",className:$.filterInput}),(0,K.jsxs)("div",{className:$.filterInput,children:[St||(St=(0,K.jsx)(de._,{children:"Search by contact point"})),(0,K.jsx)(I.I,{onChange:e=>{let{currentTarget:t}=e;return S((e=>Object.assign({},e,{contactPoint:t.value})))},value:null!==(a=w.contactPoint)&&void 0!==a?a:"",placeholder:"Search by contact point","data-testid":"search-query-input",prefix:$t||($t=(0,K.jsx)(ue.J,{name:"search"}))})]}),(C||N)&&(0,K.jsx)(v.zx,{variant:"secondary",icon:"times",onClick:V,className:$.clearFilterBtn,children:"Clear filters"})]}),!m&&!d&&(0,K.jsx)(x.q,{actions:[p.create],children:(0,K.jsx)("div",{className:$.addMatcherBtnRow,children:(0,K.jsx)(v.zx,{className:$.addMatcherBtn,icon:"plus",onClick:T,type:"button",children:"New policy"})})})]}),(0,K.jsx)(lt,{isAddMode:m,readOnly:d,onCancelAdd:()=>{h(!1),g([...c.routes])},onChange:e=>{l(Object.assign({},c,{routes:e})),m&&h(!1)},receivers:o,routes:u,filters:{queryString:C,contactPoint:N},alertManagerSourceName:n})]}):d?Vt||(Vt=(0,K.jsx)(he,{children:(0,K.jsx)("p",{children:"There are no specific policies configured."})})):(0,K.jsx)(ve,{buttonIcon:"plus",buttonLabel:"New specific policy",onButtonClick:T,text:"You haven't created any specific policies yet.",showButton:f}):d?It||(It=(0,K.jsx)(he,{children:(0,K.jsx)("p",{children:"There is no default contact point configured for the root route."})})):(0,K.jsx)(ve,{buttonIcon:"rocket",buttonLabel:"Set a default contact point",onButtonClick:s,text:"You haven't set a default contact point for the root route yet.",showButton:f})]})},Ot=e=>({container:n.css`
      display: flex;
      flex-flow: column wrap;
    `,searchContainer:n.css`
      display: flex;
      flex-flow: row nowrap;
      padding-bottom: ${e.spacing(2)};
      border-bottom: 1px solid ${e.colors.border.strong};
    `,clearFilterBtn:n.css`
      align-self: flex-end;
      margin-left: ${e.spacing(1)};
    `,filterInput:n.css`
      width: 340px;
      & + & {
        margin-left: ${e.spacing(1)};
      }
    `,addMatcherBtnRow:n.css`
      display: flex;
      flex-flow: column nowrap;
      padding: ${e.spacing(2)} 0;
    `,addMatcherBtn:n.css`
      align-self: flex-end;
    `});var _t;const Mt=(0,o.Pf)((()=>{var e;const t=(0,c.I0)(),a=(0,i.wW)(kt),[n,o]=(0,r.useState)(!1),v=(0,Ve.k)("notification"),[x,j]=(0,$e.k)(v),f=(0,Te._)((e=>e.amConfigs)),b=(0,r.useCallback)((()=>{x&&t((0,Ye.Yh)(x))}),[x,t]);(0,r.useEffect)((()=>{b()}),[b]);const{result:y,loading:C,error:N}=x&&f[x]||Se.oq,w=null==y?void 0:y.alertmanager_config,[I,S]=(0,r.useMemo)((()=>W(null==w?void 0:w.route)),[null==w?void 0:w.route]),$=z((null!==(e=null==w?void 0:w.receivers)&&void 0!==e?e:[]).map((e=>e.name))),V=(0,r.useMemo)((()=>{var e;return Boolean(null==w||null===(e=w.route)||void 0===e?void 0:e.provenance)}),[null==w?void 0:w.route]),O=()=>{o(!0)},_=()=>{o(!1)};(0,d.x)((e=>e.unifiedAlerting.saveAMConfig=Se.oq));const M=e=>{if(!y)return;const a=B(x,Object.assign({},I,e),S);n&&_(),t((0,Ye.mM)({newConfig:Object.assign({},y,{alertmanager_config:Object.assign({},y.alertmanager_config,{route:a})}),oldConfig:y,alertManagerSourceName:x,successMessage:"Saved",refetch:!0}))};if(!x)return(0,K.jsx)(g.J,{pageId:"am-routes",children:(0,K.jsx)(h.I,{availableAlertManagers:v})});const k=!x||((0,T.RY)(x)||V);return(0,K.jsxs)(g.J,{pageId:"am-routes",children:[(0,K.jsx)(u.P,{current:x,onChange:j,dataSources:v}),N&&!C&&(0,K.jsx)(l.b,{severity:"error",title:"Error loading Alertmanager config",children:N.message||"Unknown error."}),(0,K.jsx)(m.u,{currentAlertmanager:x}),V&&(0,K.jsx)(p.Xq,{resource:p.Uv.RootNotificationPolicy}),C&&(_t||(_t=(0,K.jsx)(s.u,{text:"Loading Alertmanager config..."}))),y&&!C&&!N&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(se,{readOnly:k,alertManagerSourceName:x,isEditMode:n,onSave:M,onEnterEditMode:O,onExitEditMode:_,receivers:$,routes:I}),(0,K.jsx)("div",{className:a.break}),(0,K.jsx)(Tt,{alertManagerSourceName:x,onChange:M,readOnly:k,onRootRouteEdit:O,receivers:$,routes:I}),(0,K.jsx)("div",{className:a.break}),(0,K.jsx)(Ze,{alertManagerSourceName:x})]})]})}),{style:"page"}),kt=e=>({break:n.css`
    width: 100%;
    height: 0;
    margin-bottom: ${e.spacing(2)};
  `})},23559:(e,t,a)=>{a.d(t,{h:()=>n});const n=a(47175).C.injectEndpoints({endpoints:e=>({getAlertmanagerChoiceStatus:e.query({query:()=>({url:"/api/v1/ngalert"}),providesTags:["AlertmanagerChoice"]}),getExternalAlertmanagerConfig:e.query({query:()=>({url:"/api/v1/ngalert/admin_config"}),providesTags:["AlertmanagerChoice"]}),getExternalAlertmanagers:e.query({query:()=>({url:"/api/v1/ngalert/alertmanagers"}),transformResponse:e=>e.data}),saveExternalAlertmanagersConfig:e.mutation({query:e=>({url:"/api/v1/ngalert/admin_config",method:"POST",data:e}),invalidatesTags:["AlertmanagerChoice"]})})})},73615:(e,t,a)=>{a.d(t,{J:()=>i});a(68404);var n=a(37417),r=a(45916);const i=e=>{let{children:t,pageId:a,pageNav:i,isLoading:l}=e;return(0,r.jsx)(n.T,{pageNav:i,navId:a,children:(0,r.jsx)(n.T.Contents,{isLoading:l,children:t})})}},60277:(e,t,a)=>{a.d(t,{q:()=>i});a(68404);var n=a(59196),r=a(45916);const i=e=>{let{actions:t,children:a,fallback:i=!0}=e;return t.some((e=>n.Vt.hasAccess(e,i)))?(0,r.jsx)(r.Fragment,{children:a}):null}},62791:(e,t,a)=>{a.d(t,{u:()=>d});var n=a(52423),r=(a(68404),a(16755)),i=a(2843),l=a(8157),s=a(23559),o=a(43271),c=a(45916);function d(e){let{currentAlertmanager:t}=e;const a=(0,r.wW)(u),{useGetAlertmanagerChoiceStatusQuery:n}=s.h,{currentData:d}=n(),g=t===o.GC;if(!((null==d?void 0:d.alertmanagersChoice)&&[l.TE.External,l.TE.All].includes(null==d?void 0:d.alertmanagersChoice))||!g)return null;const m=d.numExternalAlertmanagers>0;return d.alertmanagersChoice===l.TE.External?(0,c.jsxs)(i.b,{title:"Grafana alerts are not delivered to Grafana Alertmanager",children:["Grafana is configured to send alerts to external Alertmanagers only. Changing Grafana Alertmanager configuration will not affect delivery of your alerts.",(0,c.jsx)("div",{className:a.adminHint,children:"To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your Administrator."})]}):d.alertmanagersChoice===l.TE.All&&m?(0,c.jsxs)(i.b,{title:"You have additional Alertmanagers to configure",severity:"warning",children:["Ensure you make configuration changes in the correct Alertmanagers; both internal and external. Changing one will not affect the others.",(0,c.jsx)("div",{className:a.adminHint,children:"To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your Administrator."})]}):null}const u=e=>({adminHint:n.css`
    font-size: ${e.typography.bodySmall.fontSize};
    font-weight: ${e.typography.bodySmall.fontWeight};
  `})},67921:(e,t,a)=>{a.d(t,{I:()=>m});a(68404);var n,r,i,l,s=a(2843),o=a(69066),c=a(39833),d=a(45916);const u=()=>n||(n=(0,d.jsx)(s.b,{title:"No Alertmanager found",severity:"warning",children:"We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager."})),g=()=>r||(r=(0,d.jsx)(s.b,{title:"Selected Alertmanager not found. Select a different Alertmanager.",severity:"warning",children:"Selected Alertmanager no longer exists or you may not have permission to access it."})),m=e=>{let{availableAlertManagers:t}=e;const[a,n]=(0,o.k)(t),r=t.length>0;return(0,d.jsx)("div",{children:r?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(c.P,{onChange:n,dataSources:t}),i||(i=(0,d.jsx)(g,{}))]}):l||(l=(0,d.jsx)(u,{}))})}},47628:(e,t,a)=>{a.d(t,{C0:()=>c,Uv:()=>s,Xq:()=>o});a(68404);var n,r=a(2843),i=a(64313),l=a(45916);let s;!function(e){e.ContactPoint="contact point",e.Template="template",e.MuteTiming="mute timing",e.AlertRule="alert rule",e.RootNotificationPolicy="root notification policy"}(s||(s={}));const o=e=>{let{resource:t}=e;return(0,l.jsxs)(r.b,{title:`This ${t} cannot be edited through the UI`,severity:"info",children:["This ",t," has been provisioned, that means it was created by config. Please contact your server admin to update this ",t,"."]})},c=()=>n||(n=(0,l.jsx)(i.C,{text:"Provisioned",color:"purple"}))},74562:(e,t,a)=>{a.d(t,{g:()=>o});var n=a(52423),r=(a(68404),a(16755)),i=a(76961),l=a(72710),s=a(45916);const o=e=>{let{matchers:t}=e;const a=(0,r.wW)(c);return(0,s.jsx)("div",{children:(0,s.jsx)(i.P,{className:a.tags,tags:t.map((e=>`${e.name}${(0,l.zy)(e)}${e.value}`))})})},c=()=>({tags:n.css`
    justify-content: flex-start;
  `})},69066:(e,t,a)=>{a.d(t,{k:()=>o});var n=a(68404),r=a(19512),i=a(78130),l=a(74846),s=a(43271);function o(e){const[t,a]=(0,r.K)(),o=function(e){return(0,n.useCallback)((t=>e.map((e=>e.name)).includes(t)),[e])}(e),c=(0,n.useCallback)((e=>{o(e)&&(e===s.GC?(i.Z.delete(l.de),a({[l.c4]:null})):(i.Z.set(l.de,e),a({[l.c4]:e})))}),[a,o]),d=t[l.c4];if(d&&"string"==typeof d)return o(d)?[d,c]:[void 0,c];const u=i.Z.get(l.de);return u&&"string"==typeof u&&o(u)?(c(u),[u,c]):o(s.GC)?[s.GC,c]:[void 0,c]}},46150:(e,t,a)=>{a.d(t,{k:()=>i});var n=a(68404),r=a(43271);function i(e){return(0,n.useMemo)((()=>(0,r.LE)(e)),[e])}},34426:(e,t,a)=>{a.d(t,{j:()=>l});var n=a(68404),r=a(70356),i=a(80795);function l(){const{search:e}=(0,r.TH)();return[(0,n.useMemo)((()=>new URLSearchParams(e)),[e]),(0,n.useCallback)(((e,t)=>{i.E1.partial(e,t)}),[])]}}}]);
//# sourceMappingURL=AlertAmRoutes.d92d5984f48c7c04678d.js.map