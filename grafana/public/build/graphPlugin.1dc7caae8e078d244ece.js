"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1260],{84011:(e,t,i)=>{i.d(t,{O:()=>r});var s=i(61069),n=i(274),o=i(80795);const a={http:80,https:443,ftp:21};class r{constructor(){this.absUrl=this.wrapInDeprecationWarning(this.absUrl),this.hash=this.wrapInDeprecationWarning(this.hash),this.host=this.wrapInDeprecationWarning(this.host),this.path=this.wrapInDeprecationWarning(this.path),this.port=this.wrapInDeprecationWarning(this.port,"window.location"),this.protocol=this.wrapInDeprecationWarning(this.protocol,"window.location"),this.replace=this.wrapInDeprecationWarning(this.replace),this.search=this.wrapInDeprecationWarning(this.search),this.state=this.wrapInDeprecationWarning(this.state),this.url=this.wrapInDeprecationWarning(this.url)}wrapInDeprecationWarning(e,t){let i=this;return function(){return(0,s.d)("$location",e.name,t||"locationService"),e.apply(i,arguments)}}absUrl(){return`${window.location.origin}${this.url()}`}hash(e){if((0,o.GQ)("AngularLocationWrapper",!1,"Angular compat layer: hash"),e)throw new Error("AngularLocationWrapper method not implemented.");return o.E1.getLocation().hash.slice(1)}host(){return new URL(window.location.href).hostname}path(e){(0,o.GQ)("AngularLocationWrapper",!1,"Angular compat layer: path");const t=o.E1.getLocation();if(null!=e){let i=String(e);i=i.startsWith("/")?i:`/${i}`;const s=new URL(`${window.location.origin}${i}`);return o.E1.push({pathname:s.pathname,search:s.search.length>0?s.search:t.search,hash:s.hash.length>0?s.hash:t.hash}),this}return null===e?(o.E1.push("/"),this):t.pathname}port(){const e=new URL(window.location.href);return parseInt(e.port,10)||a[e.protocol]||null}protocol(){return new URL(window.location.href).protocol.slice(0,-1)}replace(){throw new Error("AngularLocationWrapper method not implemented.")}search(e,t){if((0,o.GQ)("AngularLocationWrapper",!1,"Angular compat layer: search"),!e)return o.E1.getSearchObject();if(e&&arguments.length>1)return o.E1.partial({[e]:t}),this;if(e){let t;t="object"==typeof e?Object.assign({},e):(0,o.Ox)(e);for(const e of Object.keys(t))null!==t[e]&&void 0!==t[e]||delete t[e];const i=n.Cj.renderUrl(o.E1.getLocation().pathname,t);o.E1.push(i)}return this}state(e){throw(0,o.GQ)("AngularLocationWrapper",!1,"Angular compat layer: state"),new Error("AngularLocationWrapper method not implemented.")}url(e){if((0,o.GQ)("AngularLocationWrapper",!1,"Angular compat layer: url"),void 0!==e)return e.startsWith("#")?o.E1.push(Object.assign({},o.E1.getLocation(),{hash:e})):e.startsWith("?")?o.E1.push(Object.assign({},o.E1.getLocation(),{search:e})):0===e.trim().length?o.E1.push("/"):o.E1.push(e),o.E1;const t=o.E1.getLocation();return`${t.pathname}${t.search}${t.hash}`}}},87978:(e,t,i)=>{i.d(t,{k:()=>d});var s=i(82897),n=i(28173),o=i(68633),a=i(94025),r=i(79472),l=i(13631);function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class d extends r.q{constructor(e,t){super(e,t),h(this,"contextSrv",void 0),h(this,"datasourceSrv",void 0),h(this,"timeSrv",void 0),h(this,"templateSrv",void 0),h(this,"interval",void 0),h(this,"intervalMs",void 0),h(this,"resolution",void 0),h(this,"timeInfo",void 0),h(this,"skipDataOnInit",!1),h(this,"dataList",[]),h(this,"querySubscription",void 0),h(this,"useDataFrames",!1),h(this,"panelData",void 0),h(this,"panelDataObserver",{next:e=>{if(this.panelData=e,e.state===n.Gu.Error&&(this.loading=!1,this.processDataError(e.error)),e.state===n.Gu.Loading)return this.loading=!0,void this.angularDirtyCheck();if(e.request){const{timeInfo:t}=e.request;t&&(this.timeInfo=t)}if(e.timeRange&&(this.range=e.timeRange),this.useDataFrames)this.handleDataFrames(e.series);else{const t=e.series.map((e=>(0,o.Zr)(e)));this.handleQueryResult({data:t})}this.angularDirtyCheck()}}),this.contextSrv=t.get("contextSrv"),this.datasourceSrv=t.get("datasourceSrv"),this.timeSrv=t.get("timeSrv"),this.templateSrv=t.get("templateSrv"),this.panel.datasource=this.panel.datasource||null,this.events.on(a.Kh.refresh,this.onMetricsPanelRefresh.bind(this)),this.events.on(a.Kh.panelTeardown,this.onPanelTearDown.bind(this)),this.events.on(a.Kh.componentDidMount,this.onMetricsPanelMounted.bind(this))}onMetricsPanelMounted(){const e=this.panel.getQueryRunner();this.querySubscription=e.getData({withTransforms:!0,withFieldConfig:!0}).subscribe(this.panelDataObserver)}onPanelTearDown(){this.querySubscription&&(this.querySubscription.unsubscribe(),this.querySubscription=null)}onMetricsPanelRefresh(){if(!this.otherPanelInFullscreenMode()){if(this.panel.snapshotData){this.updateTimeRange();let e=this.panel.snapshotData;return(0,s.isArray)(e)||(e=e.data),this.panelData={state:n.Gu.Done,series:e,timeRange:this.range},this.$timeout((()=>{this.events.emit(a.Kh.dataSnapshotLoad,e)}))}return delete this.error,this.loading=!0,this.datasourceSrv.get(this.panel.datasource,this.panel.scopedVars).then(this.issueQueries.bind(this)).catch((e=>{this.processDataError(e)}))}}processDataError(e){e.cancelled?console.log("Panel request cancelled",e):(this.error=e.message||"Request Error",e.data&&(e.data.message?this.error=e.data.message:e.data.error&&(this.error=e.data.error)),this.angularDirtyCheck())}angularDirtyCheck(){this.$scope.$root.$$phase||this.$scope.$digest()}updateTimeRange(e){this.datasource=e||this.datasource,this.range=this.timeSrv.timeRange();const t=(0,l.W1)(this.panel,this.range);this.timeInfo=t.timeInfo,this.range=t.timeRange}issueQueries(e){this.updateTimeRange(e),this.datasource=e;const t=this.panel;return t.getQueryRunner().run({datasource:t.datasource,queries:t.targets,panelId:t.id,dashboardId:this.dashboard.id,timezone:this.dashboard.getTimezone(),timeInfo:this.timeInfo,timeRange:this.range,maxDataPoints:t.maxDataPoints||this.width,minInterval:t.interval,publicDashboardAccessToken:this.dashboard.meta.publicDashboardAccessToken,scopedVars:t.scopedVars,cacheTimeout:t.cacheTimeout,transformations:t.transformations})}handleDataFrames(e){this.loading=!1,this.dashboard&&this.dashboard.snapshot&&(this.panel.snapshotData=e.map((e=>(0,o.og)(e))));try{this.events.emit(a.Kh.dataFramesReceived,e)}catch(e){this.processDataError(e)}}handleQueryResult(e){this.loading=!1,this.dashboard.snapshot&&(this.panel.snapshotData=e.data),e&&e.data||(console.log("Data source query result invalid, missing data field:",e),e={data:[]});try{this.events.emit(a.Kh.dataReceived,e.data)}catch(e){this.processDataError(e)}}}},79472:(e,t,i)=>{i.d(t,{q:()=>d});var s=i(82897),n=i(25317),o=i(94025),a=i(84011),r=i(46782),l=i(68374);function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class d{constructor(e,t){var i,s;h(this,"panel",void 0),h(this,"error",void 0),h(this,"pluginName",""),h(this,"pluginId",""),h(this,"editorTabs",void 0),h(this,"$scope",void 0),h(this,"$injector",void 0),h(this,"$timeout",void 0),h(this,"editModeInitiated",!1),h(this,"containerHeight",void 0),h(this,"events",void 0),h(this,"loading",!1),h(this,"timing",void 0),h(this,"$location",void 0),h(this,"onPluginTypeChange",(e=>{})),this.panel=null!==(i=this.panel)&&void 0!==i?i:e.$parent.panel,this.dashboard=null!==(s=this.dashboard)&&void 0!==s?s:e.$parent.dashboard,this.$injector=t,this.$scope=e,this.$timeout=t.get("$timeout"),this.editorTabs=[],this.$location=new a.O,this.events=new n.F,this.timing={};const l=r.ZP.panels[this.panel.type];l&&(this.pluginId=l.id,this.pluginName=l.name),e.$on(o.Kh.componentDidMount.name,(()=>this.panelDidMount()))}panelDidMount(){this.events.emit(o.Kh.componentDidMount),this.events.emit(o.Kh.initialized),this.dashboard.panelInitialized(this.panel)}renderingCompleted(){l.rv.renderingCompleted()}refresh(){this.panel.refresh()}publishAppEvent(e,t){this.$scope.$root.appEvent(e,t)}initEditMode(){this.editModeInitiated||(this.editModeInitiated=!0,this.events.emit(o.Kh.editModeInitialized))}addEditorTab(e,t,i,n){const o={title:e,directiveFn:t,icon:n};(0,s.isString)(t)&&(o.directiveFn=()=>({templateUrl:t})),i?this.editorTabs.splice(i,0,o):this.editorTabs.push(o)}getExtendedMenu(){const e=[];return this.events.emit(o.Kh.initPanelActions,e),e}async getAdditionalMenuItems(){return[]}otherPanelInFullscreenMode(){return this.dashboard.otherPanelInFullscreen(this.panel)}render(e){this.events.emit(o.Kh.render,e)}}},72691:(e,t,i)=>{i.d(t,{X:()=>o});var s=i(46782);const n=["percent_diff","percent_diff_abs"];class o{static alertToGraphThresholds(e){if(!e.alert||s.vc.unifiedAlertingEnabled)return!1;for(let i=0;i<e.alert.conditions.length;i++){var t;const s=e.alert.conditions[i];if("query"!==s.type)continue;const o=s.evaluator,a=e.thresholds=[],r=-1===n.indexOf(null===(t=s.reducer)||void 0===t?void 0:t.type);switch(o.type){case"gt":{const e=o.params[0];a.push({value:e,op:"gt",visible:r});break}case"lt":{const e=o.params[0];a.push({value:e,op:"lt",visible:r});break}case"outside_range":{const e=o.params[0],t=o.params[1];e>t?(a.push({value:e,op:"gt",visible:r}),a.push({value:t,op:"lt",visible:r})):(a.push({value:e,op:"lt",visible:r}),a.push({value:t,op:"gt",visible:r}));break}case"within_range":{const e=o.params[0],t=o.params[1];e>t?(a.push({value:e,op:"lt",visible:r}),a.push({value:t,op:"gt",visible:r})):(a.push({value:e,op:"gt",visible:r}),a.push({value:t,op:"lt",visible:r}));break}}break}for(const t of e.thresholds)t.fill=e.options.alertThreshold,t.line=e.options.alertThreshold,t.colorMode="critical";return!0}}},3420:(e,t,i)=>{i.d(t,{y:()=>c});var s=i(12717),n=i(22458),o=i(28173),a=i(71855),r=i(46782),l=i(8959),h=i(8343),d=i(53091),p=i(13631);function c(e,t){const i=(0,h.F9)(e.snapshotData),c=new l.g,u={dashboard:t,range:(0,s.JK)()},m=c.canWork(u)?c.getAnnotationsInSnapshot(t,e.id):[],g=[new n.i(m)];return{timeRange:(0,p.W1)(e,(0,d.$t)().timeRange()).timeRange,state:o.Gu.Done,series:(0,a.SM)({data:i,fieldConfig:{defaults:{},overrides:[]},replaceVariables:e.replaceVariables,fieldConfigRegistry:e.plugin.fieldConfigRegistry,theme:r.vc.theme2,timeZone:t.getTimezone()}),annotations:g}}},48951:(e,t,i)=>{i.d(t,{H:()=>l,n:()=>r});var s=i(68633),n=i(55343),o=i(79869),a=i(2417);const r=e=>{const t=e.field.links;if(t&&0!==t.length)return{getLinks:i=>{const r={};if(e.view){const{dataFrame:t}=e.view;r.__series={value:{name:t.name,refId:t.refId},text:"Series"};const i=void 0!==e.colIndex?t.fields[e.colIndex]:void 0;if(i){if(r.__field={value:{name:i.name,labels:i.labels},text:"Field"},void 0!==e.rowIndex&&e.rowIndex>=0){const{timeField:o}=(0,s.sV)(t);r.__value={value:{raw:i.values.get(e.rowIndex),numeric:e.display.numeric,text:(0,n.zc)(e.display),time:o?o.values.get(e.rowIndex):void 0},text:"Value"}}e.view&&(r.__data={value:{name:t.name,refId:t.refId,fields:(0,o.z)({frame:t,rowIndex:e.rowIndex})},text:"Data"})}else r.__value={value:{raw:e.display.numeric,numeric:e.display.numeric,text:(0,n.zc)(e.display),calc:e.name},text:"Value"}}else console.log("VALUE",e);const l=(e,t,s)=>{const n=Object.assign({},r,t);return i(e,n,s)};return t.map((t=>(0,a.Bq)().getDataLinkUIModel(t,l,e)))}}},l=e=>{const t=e.links;if(t&&0!==t.length)return{getLinks:()=>t.map((t=>(0,a.Bq)().getDataLinkUIModel(t,e.replaceVariables,e)))}}},74461:(e,t,i)=>{i.d(t,{$:()=>c});var s=i(82897),n=i(68633),o=i(27843),a=i(32934),r=i(88246),l=i(57971),h=i(36577),d=i(46782),p=i(14186);class c{constructor(e){this.panel=e}getSeriesList(e){const t=[],{dataList:i,range:s}=e;if(!i||!i.length)return t;for(let e=0;e<i.length;e++){let l=i[e],{timeField:d}=(0,n.sV)(l);if(d){l=(0,h.w)({frame:l,refFieldName:d.name}),d=(0,n.sV)(l).timeField;for(let n=0;n<l.fields.length;n++){const h=l.fields[n];if(h.type!==o.fS.number)continue;const p=(0,a.C)(h,l,i),c=[];for(let e=0;e<l.length;e++)c.push([h.values.get(e),(0,r.CQ)(d.values.get(e)).valueOf()]);t.push(this.toTimeSeries(h,p,e,n,c,t.length,s))}}}if("histogram"===this.panel.xaxis.mode&&!this.panel.stack&&t.length>1){const e=t[0];e.alias=e.aliasEscaped="Count";for(let i=1;i<t.length;i++)e.datapoints=e.datapoints.concat(t[i].datapoints);return[e]}return t}toTimeSeries(e,t,i,s,n,o,a){const r=o%l.O9.length,h=this.panel.aliasColors[t]||l.O9[r],c=new p.Z({datapoints:n||[],alias:t,color:d.ZP.theme2.visualization.getColorByName(h),unit:e.config?e.config.unit:void 0,dataFrameIndex:i,fieldIndex:s});if(n&&n.length>0&&a){const e=n[n.length-1][1],t=a.from;if(e-t.valueOf()<-1e4){n[0][1]-t.valueOf()<-1e4&&(c.isOutsideRange=!0)}}return c}setPanelDefaultsForNewXAxisMode(){switch(this.panel.xaxis.mode){case"time":this.panel.bars=!1,this.panel.lines=!0,this.panel.points=!1,this.panel.legend.show=!0,this.panel.tooltip.shared=!0,this.panel.xaxis.values=[];break;case"series":this.panel.bars=!0,this.panel.lines=!1,this.panel.points=!1,this.panel.stack=!1,this.panel.legend.show=!1,this.panel.tooltip.shared=!1,this.panel.xaxis.values=["total"];break;case"histogram":this.panel.bars=!0,this.panel.lines=!1,this.panel.points=!1,this.panel.stack=!1,this.panel.legend.show=!1,this.panel.tooltip.shared=!1}}validateXAxisSeriesValue(){if("series"!==this.panel.xaxis.mode);else{if(0===this.panel.xaxis.values.length)return void(this.panel.xaxis.values=["total"]);const e=this.getXAxisValueOptions({});(0,s.find)(e,{value:this.panel.xaxis.values[0]})||(this.panel.xaxis.values=["total"])}}getXAxisValueOptions(e){return"series"===this.panel.xaxis.mode?[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Total",value:"total"},{text:"Count",value:"count"}]:[]}pluckDeep(e,t){const i=t.split(".");let s=e;for(let e=0;e<i.length;++e){if(!s[i[e]])return;s=s[i[e]]}return s}}},75678:(e,t,i)=>{i.r(t),i.d(t,{GraphCtrl:()=>rt,plugin:()=>lt});i(89377),i(4027),i(59554),i(65103),i(85095),i(28844),i(26189),i(47825);var s=i(21256),n=i.n(s),o=i(82897),a=i(13426),r=i.n(a),l=i(23106);function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}v.$inject=["plot"];const d=(e,t,i)=>{const s=(0,l.V)(),n=document.createElement("div");n.innerHTML='<annotation-tooltip event="event" on-edit="onEdit()"></annotation-tooltip>',s.invoke(["$compile","$rootScope",(s,o)=>{const a=i.getOptions().events.manager,l=o.$new(!0);l.event=t,l.onEdit=()=>{a.editEvent(t)},s(n)(l),l.$digest(),l.$destroy();const h=new(r())({target:e[0],content:n,position:"bottom center",classes:"drop-popover drop-popover--annotation",openOn:"hover",hoverCloseDelay:200,tetherOptions:{constraints:[{to:"window",pin:!0,attachment:"both"}]}});h.open(),h.on("close",(()=>{setTimeout((()=>{h.destroy()}))}))}])};d.$inject=["element","event","plot"];let p=null;const c=(e,t,i)=>{const s=i.getOptions().events.manager;s.editorOpen?p=e:(s.editorOpened(),p=e,setTimeout((()=>{const e=(0,l.V)(),i=document.createElement("div");i.innerHTML='<event-editor panel-ctrl="panelCtrl" event="event" close="close()"></event-editor>',e.invoke(["$compile","$rootScope",(e,n)=>{const o=n.$new(!0);let a;o.event=t,o.panelCtrl=s.panelCtrl,o.close=()=>{a.close()},e(i)(o),o.$digest(),a=new(r())({target:p[0],content:i,position:"bottom center",classes:"drop-popover drop-popover--form",openOn:"click",tetherOptions:{constraints:[{to:"window",pin:!0,attachment:"both"}]}}),a.open(),s.editorOpened(),a.on("close",(()=>{setTimeout((()=>{s.editorClosed(),o.$destroy(),a.destroy()}))}))}])}),100))};c.$inject=["element","event","plot"];class u{constructor(e,t,i,s,n,o,a,r){h(this,"_object",void 0),h(this,"_drawFunc",void 0),h(this,"_clearFunc",void 0),h(this,"_moveFunc",void 0),h(this,"_position",void 0),h(this,"_width",void 0),h(this,"_height",void 0),this._object=e,this._drawFunc=t,this._clearFunc=i,this._moveFunc=s,this._position={left:n,top:o},this._width=a,this._height=r}width(){return this._width}height(){return this._height}position(){return this._position}draw(){this._drawFunc(this._object)}clear(){this._clearFunc(this._object)}getObject(){return this._object}moveTo(e){this._position=e,this._moveFunc(this._object,this._position)}}u.$inject=["object","drawFunc","clearFunc","moveFunc","left","top","width","height"];class m{constructor(e,t){h(this,"_parent",void 0),h(this,"_options",void 0),h(this,"_drawableEvent",void 0),h(this,"_hidden",void 0),this._options=e,this._drawableEvent=t,this._hidden=!1}visual(){return this._drawableEvent}getOptions(){return this._options}getParent(){return this._parent}isHidden(){return this._hidden}hide(){this._hidden=!0}unhide(){this._hidden=!1}}m.$inject=["options","drawableEvent"];class g{constructor(e){h(this,"_events",void 0),h(this,"_types",void 0),h(this,"_plot",void 0),h(this,"eventsEnabled",void 0),this._events=[],this._types=[],this._plot=e,this.eventsEnabled=!1}getEvents(){return this._events}setTypes(e){return this._types=e}setupEvents(e){const t=(0,o.partition)(e,"isRegion"),i=t[0];e=t[1],n().each(e,((e,t)=>{const i=new m(t,this._buildDiv(t));this._events.push(i)})),n().each(i,((e,t)=>{const i=new m(t,this._buildRegDiv(t));this._events.push(i)})),this._events.sort(((e,t)=>{const i=e.getOptions(),s=t.getOptions();return i.min>s.min?1:i.min<s.min?-1:0}))}drawEvents(){n().each(this._events,((e,t)=>{const i=t.getOptions(),s=this._insidePlot(i.min)||this._insidePlot(i.timeEnd),n=this._overlapPlot(i.min,i.timeEnd);!s&&!n||t.isHidden()?t.visual().getObject().hide():t.visual().draw()}))}updateEvents(){const e=this._plot.getPlotOffset();let t,i;const s=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1];n().each(this._events,((n,o)=>{i=e.top+this._plot.height()-o.visual().height(),t=s.p2c(o.getOptions().min)+e.left-o.visual().width()/2,o.visual().moveTo({top:i,left:t})}))}_clearEvents(){n().each(this._events,((e,t)=>{t.visual().clear()})),this._events=[]}_buildDiv(e){var t,i;const s=this,o=this._plot.getPlaceholder(),a=this._plot.getPlotOffset(),r=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1];let l,h,p,m,g,v,f,x;const b=e.eventType;p=null!==this._types&&this._types[b]&&this._types[b].color?this._types[b].color:"#666",m=null!==this._types&&this._types[b]&&this._types[b].markerSize?this._types[b].markerSize:8,g=null===this._types||!this._types[b]||void 0===this._types[b].markerShow||this._types[b].markerShow,x=null===this._types||!this._types[b]||void 0===this._types[b].markerTooltip||this._types[b].markerTooltip,v=null!=this._types&&this._types[b]&&this._types[b].lineStyle?this._types[b].lineStyle.toLowerCase():"dashed",f=null!=this._types&&this._types[b]&&void 0!==this._types[b].lineWidth?this._types[b].lineWidth:1;let y=r.options.eventSectionHeight||0;y/=3,l=a.top+this._plot.height()+y,h=r.p2c(e.min)+a.left;const C=n()('<div class="events_line flot-temp-elem"></div>').css({position:"absolute",opacity:.8,left:h+"px",top:8,width:f+"px",height:this._plot.height()+.8*y,"border-left-width":f+"px","border-left-style":v,"border-left-color":p,color:p}).appendTo(o);if(g){const t=n()('<div class="events_marker"></div>').css({position:"absolute",left:-m-Math.round(f/2)+"px","font-size":0,"line-height":0,width:0,height:0,"border-left":m+"px solid transparent","border-right":m+"px solid transparent"});t.appendTo(C),this._types[b]&&this._types[b].position&&"BOTTOM"===this._types[b].position.toUpperCase()?t.css({top:l-m-8+"px","border-top":"none","border-bottom":m+"px solid "+p}):t.css({top:"0px","border-top":m+"px solid "+p,"border-bottom":"none"}),t.data({event:e});const i=function(){d(t,n()(this).data("event"),s._plot)};e.editModel&&c(t,e.editModel,s._plot);const o=()=>{s._plot.clearSelection()};x&&(t.css({cursor:"help"}),t.hover(i,o))}return new u(C,(function(e){e.show()}),(e=>{e.remove()}),((e,t)=>{e.css({top:t.top,left:t.left})}),h,l,null!==(t=C.width())&&void 0!==t?t:1,null!==(i=C.height())&&void 0!==i?i:1)}_buildRegDiv(e){var t,i;const s=this,a=this._plot.getPlaceholder(),r=this._plot.getPlotOffset(),l=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1];let h,p,m,g,v,f,x;const b=e.eventType;f=null!==this._types&&this._types[b]&&this._types[b].color?this._types[b].color:"#666",x=null===this._types||!this._types[b]||void 0===this._types[b].markerTooltip||this._types[b].markerTooltip,m=null!=this._types&&this._types[b]&&void 0!==this._types[b].lineWidth?this._types[b].lineWidth:1,v=null!=this._types&&this._types[b]&&this._types[b].lineStyle?this._types[b].lineStyle.toLowerCase():"dashed";h=r.top+this._plot.height()+2;const y=Math.min(e.min,e.timeEnd),C=Math.max(e.min,e.timeEnd);p=l.p2c(y)+r.left;const w=l.p2c(C)+r.left,[S,O]=[r.left,r.left+this._plot.width()],_=Math.max(p,S);g=Math.min(w,O)-_+(w>O?0:m),(0,o.each)([p,w],(e=>{if(S<=e&&e<O){n()('<div class="events_line flot-temp-elem"></div>').css({position:"absolute",opacity:.8,left:e+"px",top:8,width:m+"px",height:this._plot.height()+2,"border-left-width":m+"px","border-left-style":v,"border-left-color":f,color:f}).appendTo(a)}}));const T=n()('<div class="events_marker region_marker flot-temp-elem"></div>').css({position:"absolute",opacity:.5,left:_+"px",top:h,width:g+"px",height:"0.5rem","border-left-color":f,color:f,"background-color":f});T.appendTo(a),T.data({event:e});const k=function(){d(T,n()(this).data("event"),s._plot)};e.editModel&&c(T,e.editModel,s._plot);const M=()=>{s._plot.clearSelection()};x&&(T.css({cursor:"help"}),T.hover(k,M));return new u(T,(function(e){e.show()}),(e=>{e.remove()}),((e,t)=>{e.css({top:t.top,left:t.left})}),p,h,null!==(t=T.width())&&void 0!==t?t:1,null!==(i=T.height())&&void 0!==i?i:1)}_insidePlot(e){const t=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1],i=t.p2c(e);return i>0&&i<t.p2c(t.max)}_overlapPlot(e,t){const i=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1],[s,n]=[i.p2c(e),i.p2c(t)],[o,a]=[0,i.p2c(i.max)];return o<s&&n<a}}function v(e){const t=this,i=new g(e);e.getEvents=()=>i._events,e.hideEvents=()=>{n().each(i._events,((e,t)=>{t.visual().getObject().hide()}))},e.showEvents=()=>{e.hideEvents(),n().each(i._events,((e,t)=>{t.hide()})),t.eventMarkers.drawEvents()},e.setEvents=e=>{i.eventsEnabled&&i.setupEvents(e)},e.hooks.processOptions.push(((e,t)=>{null!=t.events.data&&(i.eventsEnabled=!0)})),e.hooks.draw.push((e=>{const t=e.getOptions();i.eventsEnabled&&(i.getEvents().length<1?(i.setTypes(t.events.types),i.setupEvents(t.events.data)):i.updateEvents()),i.drawEvents()}))}g.$inject=["plot"];n().plot.plugins.push({init:v,options:{events:{data:null,types:null,xaxis:1,position:"BOTTOM"}},name:"events",version:"0.2.5"});var f=i(68404),x=i(97394),b=i(94025),y=i(92721),C=i(88246),w=i(39949),S=i(43917),O=i(27843),_=i(32898),T=i(68633),k=i(85449),M=i(55343),D=i(32735),E=i(32280),A=i(46782),L=i(68374),$=i(72122),I=i(92720),P=i(48951),R=i(99500),j=i(22222),N=i(9085),F=i.n(N),W=i(25004),z=i(32933),V=i(10814),H=i(45916);function B(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const U=["min","max","avg","current","total"];class X extends f.PureComponent{constructor(e){super(e),B(this,"onLabelClick",(e=>this.props.onLabelClick(this.props.series,e))),B(this,"onToggleAxis",(()=>{const e=2===this.state.yaxis?1:2,t={alias:this.props.series.alias,yaxis:e};this.setState({yaxis:e}),this.props.onToggleAxis(t)})),B(this,"onColorChange",(e=>{this.props.onColorChange(this.props.series,e),this.forceUpdate()})),this.state={yaxis:this.props.series.yaxis}}renderLegendValues(){const{series:e,asTable:t}=this.props,i=[];for(const s of U)if(this.props[s]){const n=e.formatValue(e.stats[s]);i.push((0,H.jsx)(Y,{valueName:s,value:n,asTable:t,onValueClick:this.onLabelClick},s))}return i}render(){const{series:e,values:t,asTable:i,hidden:s}=this.props,n=F()({"graph-legend-series-hidden":s,"graph-legend-series--right-y":2===e.yaxis}),o=t?this.renderLegendValues():[],a=(0,H.jsx)(G,{label:e.alias,color:e.color,yaxis:this.state.yaxis,onLabelClick:this.onLabelClick,onColorChange:this.onColorChange,onToggleAxis:this.onToggleAxis});return i?(0,H.jsxs)("tr",{className:`graph-legend-series ${n}`,children:[(0,H.jsx)("td",{role:"gridcell",children:(0,H.jsx)("div",{className:"graph-legend-series__table-name",children:a})}),o]}):(0,H.jsxs)("div",{className:`graph-legend-series ${n}`,children:[a,o]})}}B(X,"defaultProps",{asTable:!1,hidden:!1,onLabelClick:()=>{},onColorChange:()=>{},onToggleAxis:()=>{}});class G extends f.PureComponent{render(){const{label:e,color:t,yaxis:i}=this.props,{onColorChange:s,onToggleAxis:n}=this.props,o=this.props.onLabelClick?this.props.onLabelClick:()=>{};return[(0,H.jsx)(Z,{color:t,yaxis:i,onColorChange:s,onToggleAxis:n},"icon"),(0,H.jsx)("button",{type:"button",className:"graph-legend-alias pointer",title:e,onClick:o,"aria-label":W.wl.components.Panels.Visualization.Graph.Legend.legendItemAlias(e),children:e},"label")]}}B(G,"defaultProps",{yaxis:void 0,onLabelClick:()=>{}});class Z extends f.PureComponent{constructor(){super(...arguments),B(this,"onColorChange",(e=>{const{onColorChange:t}=this.props;t&&t(e)}))}render(){return(0,H.jsx)(z.sp,{yaxis:this.props.yaxis,color:this.props.color,onChange:this.onColorChange,onToggleAxis:this.props.onToggleAxis,enableNamedColors:!0,children:e=>{let{ref:t,showColorPicker:i,hideColorPicker:s}=e;return(0,H.jsx)(V.F,{color:this.props.color,ref:t,onClick:i,onMouseLeave:s,className:"graph-legend-icon"})}})}}function Y(e){let{value:t,valueName:i,asTable:s,onValueClick:n}=e;return s?(0,H.jsx)("td",{role:"gridcell",className:`graph-legend-value ${i}`,onClick:n,children:t}):(0,H.jsx)("div",{className:`graph-legend-value ${i}`,onClick:n,children:t})}function K(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}B(Z,"defaultProps",{yaxis:void 0,onColorChange:()=>{},onToggleAxis:()=>{}});class q extends f.PureComponent{constructor(e){super(e),K(this,"onToggleSeries",((e,t)=>{if(!this.props.onToggleSeries)return;let i=Object.assign({},this.state.hiddenSeries);t.ctrlKey||t.metaKey||t.shiftKey?i[e.alias]?delete i[e.alias]:i[e.alias]=!0:i=this.toggleSeriesExclusiveMode(e),this.setState({hiddenSeries:i}),this.props.onToggleSeries(i)})),this.state={hiddenSeries:this.props.hiddenSeries}}sortLegend(){let e=[...this.props.seriesList]||[];const t=this.props.sort;return t&&this.props[t]&&this.props.alignAsTable&&(e=(0,o.sortBy)(e,(e=>{let i=e.stats[t];return null===i&&(i=-1/0),i})),this.props.sortDesc&&(e=e.reverse())),e}toggleSeriesExclusiveMode(e){const t=Object.assign({},this.state.hiddenSeries);t[e.alias]&&delete t[e.alias];return this.props.seriesList.every((i=>i.alias===e.alias||t[i.alias]))?this.props.seriesList.forEach((e=>{delete t[e.alias]})):this.props.seriesList.forEach((i=>{i.alias!==e.alias&&(t[i.alias]=!0)})),t}render(){const{optionalClass:e,rightSide:t,sideWidth:i,sort:s,sortDesc:n,hideEmpty:o,hideZero:a,values:r,min:l,max:h,avg:d,current:p,total:c}=this.props,u={values:r,min:l,max:h,avg:d,current:p,total:c},m=this.state.hiddenSeries,g={hideEmpty:o,hideZero:a},v={sort:s,sortDesc:n},f=this.sortLegend().filter((e=>!e.hideFromLegend(g))),x=`${this.props.alignAsTable?"graph-legend-table":""} ${e}`,b={minWidth:t&&i?i:void 0,width:t&&i?i-1:void 0},y=Object.assign({seriesList:f,hiddenSeries:m,onToggleSeries:this.onToggleSeries,onToggleAxis:this.props.onToggleAxis,onToggleSort:this.props.onToggleSort,onColorChange:this.props.onColorChange},u,v);return(0,H.jsx)("div",{className:`graph-legend-content ${x}`,style:b,children:this.props.alignAsTable?(0,H.jsx)(J,Object.assign({},y)):(0,H.jsx)(Q,Object.assign({},y))})}}K(q,"defaultProps",{values:!1,min:!1,max:!1,avg:!1,current:!1,total:!1,alignAsTable:!1,rightSide:!1,sort:void 0,sortDesc:!1,optionalClass:"",onToggleSeries:()=>{},onToggleSort:()=>{},onToggleAxis:()=>{},onColorChange:()=>{}});class Q extends f.PureComponent{render(){const{seriesList:e,hiddenSeries:t,values:i,min:s,max:n,avg:o,current:a,total:r}=this.props,l={values:i,min:s,max:n,avg:o,current:a,total:r};return e.map(((e,i)=>(0,H.jsx)(X,Object.assign({series:e,hidden:t[e.alias]},l,{onLabelClick:this.props.onToggleSeries,onColorChange:this.props.onColorChange,onToggleAxis:this.props.onToggleAxis}),`${e.id}-${i}`)))}}class J extends f.PureComponent{constructor(){super(...arguments),K(this,"onToggleSort",(e=>{if(!this.props.onToggleSort)return;let t=this.props.sortDesc,i=this.props.sort;e!==i&&(t=void 0),!1===t?(i=void 0,t=void 0):(t=!t,i=e),this.props.onToggleSort(i,t)}))}render(){const e=this.props.seriesList,{values:t,min:i,max:s,avg:n,current:o,total:a,sort:r,sortDesc:l,hiddenSeries:h}=this.props,d={values:t,min:i,max:s,avg:n,current:o,total:a};return e?(0,H.jsxs)("table",{role:"grid",children:[(0,H.jsx)("colgroup",{children:(0,H.jsx)("col",{style:{width:"100%"}})}),(0,H.jsx)("thead",{children:(0,H.jsxs)("tr",{children:[(0,H.jsx)("th",{style:{textAlign:"left"}}),U.map((e=>d[e]&&(0,H.jsx)(ee,{statName:e,sort:r,sortDesc:l,onClick:this.onToggleSort},e)))]})}),(0,H.jsx)("tbody",{children:e&&e.map(((e,t)=>(0,H.jsx)(X,Object.assign({asTable:!0,series:e,hidden:h[e.alias],onLabelClick:this.props.onToggleSeries,onColorChange:this.props.onColorChange,onToggleAxis:this.props.onToggleAxis},d),`${e.id}-${t}`)))})]}):null}}class ee extends f.PureComponent{constructor(){super(...arguments),K(this,"onClick",(()=>{this.props.onClick&&this.props.onClick(this.props.statName)}))}render(){const{statName:e,sort:t,sortDesc:i}=this.props;return(0,H.jsxs)("th",{className:"pointer",onClick:this.onClick,children:[e,t===e&&(0,H.jsx)(R.J,{name:i?"angle-down":"angle-up"})]})}}class te extends f.PureComponent{render(){return(0,H.jsx)(j.$,{hideHorizontalTrack:!0,children:(0,H.jsx)(q,Object.assign({},this.props))})}}function ie(e,t){if(isNaN(t)||(2!==(i=e).length||!se(i[0])||!se(i[1])))return;var i;const[s,n]=e;!function(e,t,i){0!==i&&(e.min-=i,e.max-=i,t.min-=i,t.max-=i)}(s,n,t),function(e,t){const i=.25;e.max===e.min&&(e.min-=i,e.max+=i);t.max===t.min&&(t.min-=i,t.max+=i)}(s,n);const o=0===s.min||0===n.min||0===s.max||0===n.max,a=ne(s,n);if(o&&a)s.min=s.max>0?0:s.min,s.max=s.max>0?s.max:0,n.min=n.max>0?0:n.min,n.max=n.max>0?n.max:0;else if(function(e,t){return e.min>=0&&t.max<=0||e.max<=0&&t.min>=0}(s,n))s.min>=0?(s.min=-s.max,n.max=-n.min):(s.max=-s.min,n.min=-n.max);else{const e=function(e,t){if(oe(e,t)){const i=t.min?e.min/t.min:0,s=t.max?e.max/t.max:0;return i>s?i:s}if(ne(e,t)){const i=Math.abs(e.min),s=Math.abs(e.max),n=Math.abs(t.min),o=Math.abs(t.max),a=Math.max(i,s),r=Math.min(i,s),l=Math.max(n,o),h=Math.min(n,o),d=0!==r?a/r:a,p=0!==h?l/h:l;return d>p?d:p}return e.min>0||t.min>0?e.max/t.max:e.min/t.min}(s,n);a?s.min>0?(s.min=s.max/e,n.min=n.max/e):(s.max=s.min/e,n.max=n.min/e):oe(s,n)?(s.min=n.min?n.min*e:s.min,n.min=s.min?s.min/e:n.min,s.max=n.max?n.max*e:s.max,n.max=s.max?s.max/e:n.max):(s.min=s.min>0?n.min*e:s.min,n.min=n.min>0?s.min/e:n.min,s.max=s.max<0?n.max*e:s.max,n.max=n.max<0?s.max/e:n.max)}!function(e,t,i){0!==i&&(e.min+=i,e.max+=i,t.min+=i,t.max+=i)}(s,n,t)}function se(e){return"min"in e&&"max"in e}function ne(e,t){return e.min>=0&&t.min>=0||e.max<=0&&t.max<=0}function oe(e,t){return e.min<=0&&e.max>=0&&t.min<=0&&t.max>=0}var ae=i(35008),re=i.n(ae),le=i(57971);function he(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class de{constructor(e){he(this,"event",null),he(this,"editorOpen",!1),this.panelCtrl=e}editorClosed(){this.event=null,this.editorOpen=!1,this.panelCtrl.render()}editorOpened(){this.editorOpen=!0}updateTime(e){this.event||(this.event={},this.event.dashboardUID=this.panelCtrl.dashboard.uid,this.event.panelId=this.panelCtrl.panel.id),this.event.time=e.from,this.event.isRegion=!1,e.to&&(this.event.timeEnd=e.to,this.event.isRegion=!0),this.panelCtrl.render()}editEvent(e,t){this.event=e,this.panelCtrl.render()}addFlotEvents(e,t){if(!this.event&&0===e.length)return;const i={$__alerting:{color:le.ns,position:"BOTTOM",markerSize:5},$__ok:{color:le.te,position:"BOTTOM",markerSize:5},$__no_data:{color:le._V,position:"BOTTOM",markerSize:5},$__pending:{color:le.f7,position:"BOTTOM",markerSize:5},$__editing:{color:le.Jx,position:"BOTTOM",markerSize:5}};if(this.event)e=this.event.isRegion?[{isRegion:!0,min:this.event.time,timeEnd:this.event.timeEnd,text:this.event.text,eventType:"$__editing",editModel:this.event}]:[{min:this.event.time,text:this.event.text,editModel:this.event,eventType:"$__editing"}];else for(let t=0;t<e.length;t++){const s=e[t];s.min=s.time,s.max=s.time,s.eventType=s.type,s.newState?s.eventType="$__"+s.newState:i[s.type]||(i[s.type]={color:s.color,position:"BOTTOM",markerSize:5})}const s=function(e){return(0,o.filter)(e,"isRegion")}(e);!function(e,t){const i=t.grid.markings,s=le.Jx;let n;(0,o.each)(e,(e=>{n=e.source&&e.color||s,n=function(e,t){const i=re()(e);return i.isValid()?(i.setAlpha(t),i.toRgbString()):e}(n,le.iV),i.push({xaxis:{from:e.min,to:e.timeEnd},color:n})}))}(s,t);t.grid.eventSectionHeight=7,t.xaxis.eventSectionHeight=20,t.events={levels:(0,o.keys)(i).length+1,data:e,types:i,manager:this}}}var pe=i(74333),ce=i(76093),ue=i(64850);function me(e,t,i,s){const o=this,a=i.ctrl.panel,r=new b.IA({pos:{},point:{},panel:this.panel}),l=n()('<div class="graph-tooltip">');this.destroy=()=>{l.remove()},this.findHoverIndexFromDataPoints=(e,t,i)=>{const s=t.datapoints.pointsize,n=i*s,o=t.datapoints.points.length;let a;for(a=n;a<o;a+=s)if(!t.lines.steps&&null!=t.datapoints.points[n]&&null==t.datapoints.points[a]||t.datapoints.points[a]>e)return Math.max(a-s,0)/s;return a/s-1},this.findHoverIndexFromData=(e,t)=>{let i,s=0,n=t.data.length-1;for(;;){if(s>n)return Math.max(n,0);if(i=Math.floor((s+n)/2),t.data[i][0]===e)return i;t.data[i][0]<e?s=i+1:n=i-1}},this.renderAndShow=(e,t,i,s)=>{"time"===s&&(t='<div class="graph-tooltip-time">'+e+"</div>"+t),l.html(t).place_tt(i.pageX,i.pageY,{offset:10})},this.getMultiSeriesPlotHoverInfo=function(e,t){let i,s,n,o,r,l,h,d,p,c=[[],[],[]],u=0;for(s=0;s<e.length;s++)n=e[s],!n.data.length||a.legend.hideEmpty&&n.allIsNull||!n.data.length||a.legend.hideZero&&n.allIsZero||n.hideTooltip?c[0].push({hidden:!0,value:0}):(o=this.findHoverIndexFromData(t.x,n),r=t.x-n.data[o][0],l=n.data[o][0],(!d||r>=0&&(r<d||d<0)||r<0&&r>d)&&(d=r,p=l),i=n.data[o][1],n.stack&&null!==i&&"individual"!==a.tooltip.value_type&&(u+=i,i=u),(n.lines.steps||n.stack)&&(o=this.findHoverIndexFromDataPoints(t.x,n,o)),h=0,n.yaxis&&(h=n.yaxis.n),c[h].push({value:i,hoverIndex:o,color:n.color,label:n.aliasEscaped,time:l,distance:r,index:s}));return c=c[0].concat(c[1],c[2]),c.time=p,c},e.mouseleave((()=>{var i;if(null!==(i=a.tooltip)&&void 0!==i&&i.shared){const t=e.data().plot;t&&(l.detach(),t.unhighlight())}t.events.publish(new b.oi),t.events.publish(new y.xH)})),e.bind("plothover",((i,s,n)=>{o.show(s,n),t.panelInEdit||(s.panelRelY=(s.pageY-e.offset().top)/e.height(),r.payload.pos=s,r.payload.panel=a,r.payload.point.time=s.x,t.events.publish(r))})),e.bind("plotclick",((e,t,i)=>{L.h$.emit(ue.RW.xt,{pos:t,panel:a,item:i})})),e.bind("plotleave",(()=>{if(!a.tooltip.shared)return;const t=e.data().plot;t&&(l.detach(),t.unhighlight())})),this.clear=e=>{l.detach(),e.clearCrosshair(),e.unhighlight()},this.show=(i,r)=>{const h=e.data().plot,d=h.getData(),p=h.getXAxes()[0].options.mode,c=s();let u,m,g,v,f,x,b,y,C=a.tooltip.shared;if(i.panelRelY){var w;const s=h.pointOffset({x:i.x});if(Number.isNaN(s.left)||s.left<0||s.left>e.width())return void o.clear(h);i.pageX=e.offset().left+s.left,i.pageY=e.offset().top+e.height()*i.panelRelY;const a=null!==(w=n()(window).scrollTop())&&void 0!==w?w:0;if(!(i.pageY>=a&&i.pageY<=n()(window).innerHeight()+a))return void o.clear(h);if(h.setCrosshair(i),C=!0,t.sharedCrosshairModeOnly())return}if(0!==c.length)if(y=c[0].hasMsResolution?pe.U6.fullDateMS:pe.U6.fullDate,C){h.unhighlight();const e=o.getMultiSeriesPlotHoverInfo(d,i);for(b="",g=t.formatDate(e.time,y),2===a.tooltip.sort?e.sort(((e,t)=>t.value-e.value)):1===a.tooltip.sort&&e.sort(((e,t)=>e.value-t.value)),f=0;f<e.length;f++){if(v=e[f],v.hidden)continue;let t="";r&&v.index===r.seriesIndex&&(t="graph-tooltip-list-item--highlight"),x=c[v.index],m=ce.QX.sanitize(x.formatValue(v.value));b+='<div class="graph-tooltip-list-item '+t+'"><div class="graph-tooltip-series-name">',b+='<i class="fa fa-minus" style="color:'+ce.QX.sanitize(v.color)+';"></i> '+ce.QX.sanitize(v.label)+":</div>",b+='<div class="graph-tooltip-value">'+m+"</div></div>",h.highlight(v.index,v.hoverIndex)}o.renderAndShow(g,b,i,p)}else if(r){const e=ce.QX.sanitize(r.series.color);x=c[r.seriesIndex],u='<div class="graph-tooltip-list-item"><div class="graph-tooltip-series-name">',u+='<i class="fa fa-minus" style="color:'+e+';"></i> '+x.aliasEscaped+":</div>",m=a.stack&&"individual"===a.tooltip.value_type?r.datapoint[1]-r.datapoint[2]:r.datapoint[1],m=ce.QX.sanitize(x.formatValue(m)),g=t.formatDate(r.datapoint[0],y),u+='<div class="graph-tooltip-value">'+m+"</div>",o.renderAndShow(g,u,i,p)}else l.detach()}}var ge=i(24314);function ve(e,t,i,s,n){return e.map((e=>{const o=function(e){const t=[];for(let i=0;i<e.length;i++){const s=e[i].datapoints;for(let e=0;e<s.length;e++)null!==s[e][0]&&t.push(s[e][0])}return t}([e]);if(e.histogram=!0,i[e.alias])e.data=[];else{const i=function(e,t,i,s){const n=fe(i,t),o=fe(s,t);return(0,ge.histogram)().domain([n,o]).thresholds(Math.round(s-i)/t)(e).map((e=>[e.x0,e.length]))}(o,t,s,n);e.data=i}return e}))}function fe(e,t){return Math.floor(e/t)*t}function xe(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class be{constructor(e){xe(this,"plot",void 0),xe(this,"placeholder",void 0),xe(this,"height",void 0),xe(this,"thresholds",void 0),xe(this,"needsCleanup",!1),xe(this,"hasSecondYAxis",void 0),this.panelCtrl=e}getHandleHtml(e,t,i){let s=t.colorMode;return"custom"===t.colorMode&&(s="critical"),`\n    <div class="alert-handle-wrapper alert-handle-wrapper--T${e}">\n      <div class="alert-handle-line alert-handle-line--${s}">\n      </div>\n      <div class="alert-handle" data-handle-index="${e}">\n        <i class="icon-gf icon-gf-${s} alert-state-${s}"></i>\n        <span class="alert-handle-value">${i}<i class="alert-handle-grip"></i></span>\n      </div>\n    </div>`}initDragging(e){const t=n()(e.currentTarget).parents(".alert-handle-wrapper"),i=n()(e.currentTarget).data("handleIndex");let s,o=null;const a=this.plot,r=this.panelCtrl,l=this.thresholds[i];function h(e){if(null===o)o=e.clientY;else{const i=e.clientY-o;s+=i,o=e.clientY,t.css({top:s+i})}}o=null,s=t.position().top,t.on("mousemove",h),document.addEventListener("mouseup",(function e(){let n=a.c2p({left:0,top:s}).y;n=parseInt(n.toFixed(0),10),l.value=n,t.off("mousemove",h),document.removeEventListener("mouseup",e),r.$scope.$apply((()=>{r.render(),r.events.emit(ue.RW.GL,{threshold:l,handleIndex:i})}))}))}cleanUp(){this.placeholder.find(".alert-handle-wrapper").remove(),this.needsCleanup=!1}renderHandle(e,t){const i=this.thresholds[e];if(!i.visible&&this.panelCtrl.alert)return;const s=i.value;let a=s,r=0;if((0,o.isNumber)(s)){const e=this.plot.p2c({x:0,y:s});r=Math.round(Math.min(Math.max(e.top,0),this.height)-6)}else a="",r=t;const l=n()(this.getHandleHtml(e,i,a));this.placeholder.append(l),l.toggleClass("alert-handle-wrapper--no-value",""===a),l.css({top:r})}shouldDrawHandles(){return!this.hasSecondYAxis&&this.panelCtrl.editingThresholds&&this.panelCtrl.panel.thresholds.length>0}prepare(e,t){this.hasSecondYAxis=!1;for(let e=0;e<t.length;e++)if(t[e].yaxis>1){this.hasSecondYAxis=!0;break}if(this.shouldDrawHandles()){const t=this.panelCtrl.panel.thresholds.length>1?"220px":"110px";e.css("margin-right",t)}else this.needsCleanup&&e.css("margin-right","0")}draw(e){this.thresholds=this.panelCtrl.panel.thresholds,this.plot=e,this.placeholder=e.getPlaceholder(),this.needsCleanup&&this.cleanUp(),this.shouldDrawHandles()&&(this.height=e.height(),this.thresholds.length>0&&this.renderHandle(0,10),this.thresholds.length>1&&this.renderHandle(1,this.height-30),this.placeholder.off("mousedown",".alert-handle"),this.placeholder.on("mousedown",".alert-handle",this.initDragging.bind(this)),this.needsCleanup=!0)}addFlotOptions(e,t){if(!t.thresholds||0===t.thresholds.length)return;let i,s,n,a=1/0,r=-1/0;for(i=0;i<t.thresholds.length;i++){if(s=t.thresholds[i],!(0,o.isNumber)(s.value))continue;let l,h,d;switch(s.op){case"gt":l=a,t.thresholds.length>i+1&&(n=t.thresholds[i+1],n.value>s.value&&(l=n.value,r=l));break;case"lt":l=r,t.thresholds.length>i+1&&(n=t.thresholds[i+1],n.value<s.value&&(l=n.value,a=l))}switch(s.colorMode){case"critical":h="rgba(234, 112, 112, 0.12)",d="rgba(237, 46, 24, 0.60)";break;case"warning":h="rgba(235, 138, 14, 0.12)",d="rgba(247, 149, 32, 0.60)";break;case"ok":h="rgba(11, 237, 50, 0.090)",d="rgba(6,163,69, 0.60)";break;case"custom":h=s.fillColor,d=s.lineColor}s.fill&&("right"===s.yaxis&&this.hasSecondYAxis?e.grid.markings.push({y2axis:{from:s.value,to:l},color:A.vc.theme2.visualization.getColorByName(h)}):e.grid.markings.push({yaxis:{from:s.value,to:l},color:A.vc.theme2.visualization.getColorByName(h)})),s.line&&("right"===s.yaxis&&this.hasSecondYAxis?e.grid.markings.push({y2axis:{from:s.value,to:s.value},color:A.vc.theme2.visualization.getColorByName(d)}):e.grid.markings.push({yaxis:{from:s.value,to:s.value},color:A.vc.theme2.visualization.getColorByName(d)}))}}}function ye(e,t){if(!(e.fromDayOfWeek||e.from||e.toDayOfWeek||e.to))return[];const i=Object.assign({},e);i.from&&!i.to&&(i.to=i.from),!i.from&&i.to&&(i.from=i.to);const s={from:Ce(i.from),to:Ce(i.to)};if(!i.fromDayOfWeek&&i.toDayOfWeek&&(i.fromDayOfWeek=i.toDayOfWeek),!i.toDayOfWeek&&i.fromDayOfWeek&&(i.toDayOfWeek=i.fromDayOfWeek),i.fromDayOfWeek&&(s.from.dayOfWeek=Number(i.fromDayOfWeek)),i.toDayOfWeek&&(s.to.dayOfWeek=Number(i.toDayOfWeek)),s.from.dayOfWeek&&null==s.from.h&&null==s.from.m&&(s.from.h=0,s.from.m=0,s.from.s=0),s.to.dayOfWeek&&null==s.to.h&&null==s.to.m&&(s.to.h=23,s.to.m=59,s.to.s=59),!s.from||!s.to)return[];null==s.from.h&&(s.from.h=0),null==s.to.h&&(s.to.h=23);const n=[],o=(0,C.CQ)(t.from);for(o.set("hour",0),o.set("minute",0),o.set("second",0),o.add(s.from.h,"hours"),o.add(s.from.m,"minutes"),o.add(s.from.s,"seconds");o.unix()<=t.to.unix();){for(var a,r;s.from.dayOfWeek&&s.from.dayOfWeek!==o.isoWeekday();)o.add(24,"hours");if(o.unix()>t.to.unix())break;const e=(0,C.CQ)(o);if(e.hour)if(s.from.h<=s.to.h)e.add(s.to.h-s.from.h,"hours");else if(s.from.h>s.to.h)for(;e.hour()!==s.to.h;)e.add(1,"hours");else for(e.add(24-s.from.h,"hours");e.hour()!==s.to.h;)e.add(1,"hours");for(e.set("minute",null!==(a=s.to.m)&&void 0!==a?a:0),e.set("second",null!==(r=s.to.s)&&void 0!==r?r:0);s.to.dayOfWeek&&s.to.dayOfWeek!==e.isoWeekday();)e.add(24,"hours");o.unix()<t.from.unix()&&e.unix()<t.from.unix()||o.unix()>t.to.unix()&&e.unix()>t.to.unix()||n.push({from:o.valueOf(),to:e.valueOf()}),o.add(24,"hours")}return n}function Ce(e){const t={};if(null==e||!e.length)return t;const i=/^([\d]+):?(\d{2})?/.exec(e);return i?(i.length>1&&(t.h=Number(i[1]),t.m=0,i.length>2&&void 0!==i[2]&&(t.m=Number(i[2])),t.h>23&&(t.h=23),t.m>59&&(t.m=59)),t):t}function we(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Se={gray:{themeDependent:!0,title:"Gray",darkColor:{fill:"rgba(255, 255, 255, 0.09)",line:"rgba(255, 255, 255, 0.2)"},lightColor:{fill:"rgba(0, 0, 0, 0.09)",line:"rgba(0, 0, 0, 0.2)"}},red:{title:"Red",color:{fill:"rgba(234, 112, 112, 0.12)",line:"rgba(237, 46, 24, 0.60)"}},green:{title:"Green",color:{fill:"rgba(11, 237, 50, 0.090)",line:"rgba(6,163,69, 0.60)"}},blue:{title:"Blue",color:{fill:"rgba(11, 125, 238, 0.12)",line:"rgba(11, 125, 238, 0.60)"}},yellow:{title:"Yellow",color:{fill:"rgba(235, 138, 14, 0.12)",line:"rgba(247, 149, 32, 0.60)"}},custom:{title:"Custom"}};function Oe(e,t){if(-1===Object.keys(Se).indexOf(e.colorMode)&&(e.colorMode="red"),"custom"===e.colorMode)return{fill:e.fill&&e.fillColor?t.visualization.getColorByName(e.fillColor):null,line:e.line&&e.lineColor?t.visualization.getColorByName(e.lineColor):null};const i=Se[e.colorMode];return!0===i.themeDependent?t.isLight?i.lightColor:i.darkColor:{fill:e.fill?t.visualization.getColorByName(i.color.fill):null,line:e.fill?t.visualization.getColorByName(i.color.line):null}}class _e{constructor(e){we(this,"plot",void 0),we(this,"timeRegions",void 0),this.panelCtrl=e}draw(e){this.timeRegions=this.panelCtrl.panel.timeRegions,this.plot=e}addFlotOptions(e,t){var i;if(null===(i=t.timeRegions)||void 0===i||!i.length)return;const s={from:(0,C.CQ)(this.panelCtrl.range.from).utc(),to:(0,C.CQ)(this.panelCtrl.range.to).utc(),raw:{from:"",to:""}};for(const i of t.timeRegions){const t=i,n=ye(i,s);if(n.length){const i=Oe(t,A.vc.theme2);for(let s=0;s<n.length;s++){const o=n[s];t.fill&&e.grid.markings.push({xaxis:{from:o.from,to:o.to},color:i.fill}),t.line&&(e.grid.markings.push({xaxis:{from:o.from,to:o.from},color:i.line}),e.grid.markings.push({xaxis:{from:o.to,to:o.to},color:i.line}))}}}}}var Te=i(34784);function ke(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Ee.$inject=["timeSrv","popoverSrv","contextSrv"];const Me=(0,$.E)(te,A.ZP.theme2);class De{constructor(e,t,i){ke(this,"ctrl",void 0),ke(this,"contextMenu",void 0),ke(this,"tooltip",void 0),ke(this,"dashboard",void 0),ke(this,"annotations",void 0),ke(this,"panel",void 0),ke(this,"plot",void 0),ke(this,"sortedSeries",void 0),ke(this,"data",[]),ke(this,"panelWidth",void 0),ke(this,"eventManager",void 0),ke(this,"thresholdManager",void 0),ke(this,"timeRegionManager",void 0),ke(this,"getContextMenuItemsSupplier",((e,t)=>()=>{const i=this.dashboard.canAddAnnotations()?[{items:[{label:"Add annotation",ariaLabel:"Add annotation",icon:"comment-alt",onClick:()=>this.eventManager.updateTime({from:e.x,to:null})}]}]:[];if(!t)return i;const s=[{items:t.getLinks(this.panel.replaceVariables).map((e=>({label:e.title,ariaLabel:e.title,url:e.href,target:e.target,icon:"_self"===e.target?"link":"external-link-alt",onClick:e.onClick})))}];return[...i,...s]})),this.scope=e,this.elem=t,this.timeSrv=i,this.ctrl=e.ctrl,this.contextMenu=e.ctrl.contextMenuCtrl,this.dashboard=this.ctrl.dashboard,this.panel=this.ctrl.panel,this.annotations=[],this.panelWidth=0,this.eventManager=new de(this.ctrl),this.thresholdManager=new be(this.ctrl),this.timeRegionManager=new _e(this.ctrl),this.tooltip=new me(this.elem,this.ctrl.dashboard,this.scope,(()=>this.sortedSeries)),this.ctrl.events.on(b.Kh.panelTeardown,this.onPanelTeardown.bind(this)),this.ctrl.events.on(b.Kh.render,this.onRender.bind(this)),this.ctrl.dashboard.events.on(b.IA.type,this.onGraphHover.bind(this),this.scope),this.ctrl.dashboard.events.on(b.oi.type,this.onGraphHoverClear.bind(this),this.scope),this.ctrl.dashboard.events.on(y.es.type,this.onGraphHover.bind(this),this.scope),this.ctrl.dashboard.events.on(y.xH.type,this.onGraphHoverClear.bind(this),this.scope),this.elem.bind("plotselected",this.onPlotSelected.bind(this)),this.elem.bind("plotclick",this.onPlotClick.bind(this)),this.elem&&this.elem.parent&&(this.legendElem=this.elem.parent().find(".graph-legend")[0])}onRender(e){if(this.data=e||this.data,!this.data)return;this.annotations=this.ctrl.annotations||[],this.buildFlotPairs(this.data);const t=this.ctrl.height;if((0,L.Wz)(this.data,this.panel,t),!this.panel.legend.show)return this.legendElem.hasChildNodes()&&x.unmountComponentAtNode(this.legendElem),void this.renderPanel();const{values:i,min:s,max:n,avg:o,current:a,total:r}=this.panel.legend,{alignAsTable:l,rightSide:h,sideWidth:d,sort:p,sortDesc:c,hideEmpty:u,hideZero:m}=this.panel.legend,g={alignAsTable:l,rightSide:h,sideWidth:d,sort:p,sortDesc:c,hideEmpty:u,hideZero:m},v={values:i,min:s,max:n,avg:o,current:a,total:r},b=Object.assign({seriesList:this.data,hiddenSeries:this.ctrl.hiddenSeries},g,v,{onToggleSeries:this.ctrl.onToggleSeries,onToggleSort:this.ctrl.onToggleSort,onColorChange:this.ctrl.onColorChange,onToggleAxis:this.ctrl.onToggleAxis}),y=f.createElement(Me,b);x.render(y,this.legendElem,(()=>this.renderPanel()))}onGraphHover(e){var t,i;if(this.dashboard.sharedTooltipModeEnabled()){if(e.hasOwnProperty("pos")){var s;if(!this.plot||(null===(s=e.panel)||void 0===s?void 0:s.id)===this.panel.id||this.ctrl.otherPanelInFullscreenMode())return;this.tooltip.show(e.pos)}null!==(t=e.point)&&void 0!==t&&t.time&&this.tooltip.show({x:e.point.time,panelRelY:null!==(i=e.point.panelRelY)&&void 0!==i?i:1})}}onPanelTeardown(){this.plot&&(this.plot.destroy(),this.plot=null),this.tooltip.destroy(),this.elem.off(),this.elem.remove(),x.unmountComponentAtNode(this.legendElem)}onGraphHoverClear(e){this.plot&&this.tooltip.clear(this.plot)}onPlotSelected(e,t){"time"===this.panel.xaxis.mode?(t.ctrlKey||t.metaKey)&&this.dashboard.canAddAnnotations()?setTimeout((()=>{this.eventManager.updateTime(t.xaxis)}),100):this.scope.$apply((()=>{this.timeSrv.setTime({from:(0,C.zh)(t.xaxis.from),to:(0,C.zh)(t.xaxis.to)})})):this.plot.clearSelection()}onPlotClick(e,t,i){const s=this.elem.closest(".view")?this.elem.closest(".view").get()[0]:null,n=i;if("time"===this.panel.xaxis.mode)if(t.ctrlKey||t.metaKey){if(t.x!==t.x1)return;if(!this.dashboard.id||!this.dashboard.canAddAnnotations())return;setTimeout((()=>{this.eventManager.updateTime({from:t.x,to:null})}),100)}else{let e;if(this.tooltip.clear(this.plot),i){const t=this.panel.yaxes[2===i.series.yaxis.n?1:0],s=this.ctrl.dataList[i.series.dataFrameIndex],n=s.fields[i.series.fieldIndex],o=this.getDataIndexWithNullValuesCorrection(i,s);let a=this.panel.options.dataLinks||[];const r=(0,w.gG)(n);r&&(a=[...a,...n.config.links]);const l={decimals:t.decimals,links:a},h=(0,S.U)({field:{config:l,type:O.fS.number},theme:A.ZP.theme2,timeZone:this.dashboard.getTimezone()})(n.values.get(o));e=a.length?(0,P.n)({display:h,name:n.name,view:new _.U(s),rowIndex:o,colIndex:i.series.fieldIndex,field:l,hasLinks:r}):void 0}this.scope.$apply((()=>{this.contextMenu.setScrollContextElement(s),this.contextMenu.setSource(n),this.contextMenu.setMenuItemsSupplier(this.getContextMenuItemsSupplier(t,e)),this.contextMenu.toggleMenu(t)}))}}getDataIndexWithNullValuesCorrection(e,t){const{datapoint:i,dataIndex:s}=e;if(!Array.isArray(i)||0===i.length)return s;const n=i[0],{timeField:o}=(0,T.sV)(t);if(!o||!o.values)return s;if(o.values.get(s)===n)return s;const a=o.values.toArray().findIndex((e=>e===n));return a>-1?a:s}shouldAbortRender(){return!this.data||0===this.panelWidth}drawHook(e){this.panel.yaxes[0].label&&this.panel.yaxes[0].show&&n()("<div class='axisLabel left-yaxis-label flot-temp-elem'></div>").text(this.panel.yaxes[0].label).appendTo(this.elem),this.panel.yaxes[1].label&&this.panel.yaxes[1].show&&n()("<div class='axisLabel right-yaxis-label flot-temp-elem'></div>").text(this.panel.yaxes[1].label).appendTo(this.elem);const{dataWarning:t}=this.ctrl;if(t){const e=n()(`<div class="datapoints-warning flot-temp-elem">${t.title}</div>`);t.action&&n()(`<button class="btn btn-secondary">${t.actionText}</button>`).click(t.action).appendTo(e),e.appendTo(this.elem)}this.thresholdManager.draw(e),this.timeRegionManager.draw(e)}processOffsetHook(e,t){const i=this.panel.yaxes[0],s=this.panel.yaxes[1];i.show&&i.label&&(t.left=20),s.show&&s.label&&(t.right=20);const n=e.getYAxes();for(let e=0;e<n.length;e++){const t=n[e],i=this.panel.yaxes[e];t.options.max=null!==t.options.max?t.options.max:i.max,t.options.min=null!==t.options.min?t.options.min:i.min}}processRangeHook(e){const t=e.getYAxes(),i=this.panel.yaxis.align||!1;if(t.length>1&&!0===i){const e=this.panel.yaxis.alignLevel||0;ie(t,parseFloat(e))}}getMinTimeStepOfSeries(e){let t=Number.MAX_VALUE;for(let i=0;i<e.length;i++)if(e[i].stats.timeStep){if(this.panel.bars){if(e[i].bars&&!1===e[i].bars.show)continue}else if(void 0===e[i].bars||void 0===e[i].bars.show||!e[i].bars.show)continue;e[i].stats.timeStep<t&&(t=e[i].stats.timeStep)}return t}renderPanel(){var e;if(this.panelWidth=null!==(e=this.elem.width())&&void 0!==e?e:0,this.shouldAbortRender())return;this.thresholdManager.prepare(this.elem,this.data),this.panel.dashes=!!this.panel.lines&&this.panel.dashes;const t=this.buildFlotOptions(this.panel);this.prepareXAxis(t,this.panel),this.configureYAxisOptions(this.data,t),this.thresholdManager.addFlotOptions(t,this.panel),this.timeRegionManager.addFlotOptions(t,this.panel),this.eventManager.addFlotEvents(this.annotations,t),this.sortedSeries=this.sortSeries(this.data,this.panel),this.callPlot(t,!0)}buildFlotPairs(e){for(let t=0;t<e.length;t++){const i=e[t];i.data=i.getFlotPairs(i.nullPointMode||this.panel.nullPointMode),"constant"===i.transform&&(i.data=(0,k.H)(i.data,this.ctrl.range)),this.ctrl.hiddenSeries[i.alias]&&(i.data=[],i.stack=!1)}}prepareXAxis(e,t){switch(t.xaxis.mode){case"series":e.series.bars.barWidth=.7,e.series.bars.align="center";for(let e=0;e<this.data.length;e++){const i=this.data[e];i.data=[[e+1,i.stats[t.xaxis.values[0]]]]}this.addXSeriesAxis(e);break;case"histogram":{let i;if(this.data.length){let s=(0,o.min)((0,o.map)(this.data,(e=>e.stats.min))),n=(0,o.max)((0,o.map)(this.data,(e=>e.stats.max)));const a=t.xaxis.buckets||this.panelWidth/50;if(null!=t.xaxis.min){s=(0,I.tickStep)(t.xaxis.min,n,a)<=0?s:t.xaxis.min}if(null!=t.xaxis.max){n=(0,I.tickStep)(s,t.xaxis.max,a)<=0?n:t.xaxis.max}i=(0,I.tickStep)(s,n,a),e.series.bars.barWidth=.8*i,this.data=ve(this.data,i,this.ctrl.hiddenSeries,s,n)}else i=0;this.addXHistogramAxis(e,i);break}case"table":e.series.bars.barWidth=.7,e.series.bars.align="center",this.addXTableAxis(e);break;default:e.series.bars.barWidth=this.getMinTimeStepOfSeries(this.data)/1.5,this.addTimeAxis(e)}}callPlot(e,t){try{this.plot=n().plot(this.elem,this.sortedSeries,e),this.ctrl.renderError&&delete this.ctrl.error}catch(e){console.error("flotcharts error",e),this.ctrl.error=e instanceof Error?e.message:"Render Error",this.ctrl.renderError=!0}t&&this.ctrl.renderingCompleted()}buildFlotOptions(e){let t="#c8c8c8";!0===A.ZP.bootData.user.lightTheme&&(t="#a1a1a1");const i=!!e.stack||null;return{hooks:{draw:[this.drawHook.bind(this)],processOffset:[this.processOffsetHook.bind(this)],processRange:[this.processRangeHook.bind(this)]},legend:{show:!1},series:{stackpercent:!!e.stack&&e.percentage,stack:e.percentage?null:i,lines:{show:e.lines,zero:!1,fill:this.translateFillOption(e.fill),fillColor:this.getFillGradient(e.fillGradient),lineWidth:e.dashes?0:e.linewidth,steps:e.steppedLine},dashes:{show:e.dashes,lineWidth:e.linewidth,dashLength:[e.dashLength,e.spaceLength]},bars:{show:e.bars,fill:1,barWidth:1,zero:!1,lineWidth:0},points:{show:e.points,fill:1,fillColor:!1,radius:e.points?e.pointradius:2},shadowSize:0},yaxes:[],xaxis:{},grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:t,margin:{left:0,right:0},labelMarginX:0,mouseActiveRadius:30},selection:{mode:"x",color:"#666"},crosshair:{mode:"x"}}}sortSeries(e,t){const i=t.legend.sort,s=t.legend.sortDesc,n=null!=i&&t.legend[i],a=null!=s,r=t.stack&&n&&a&&t.legend.alignAsTable,l=!0===t.legend.sortDesc?-1:1;return r?(0,o.sortBy)(e,(e=>e.stats[i]*l)):(0,o.sortBy)(e,(e=>e.zindex))}getFillGradient(e){return e?{colors:[{opacity:0},{opacity:e/10}]}:null}translateFillOption(e){return this.panel.percentage&&this.panel.stack&&0===e?.001:e/10}addTimeAxis(e){const t=this.panelWidth/100,i=(0,o.isUndefined)(this.ctrl.range.from)?null:this.ctrl.range.from.valueOf(),s=(0,o.isUndefined)(this.ctrl.range.to)?null:this.ctrl.range.to.valueOf();e.xaxis={timezone:this.dashboard.getTimezone(),show:this.panel.xaxis.show,mode:"time",min:i,max:s,label:"Datetime",ticks:t,timeformat:(0,D.mc)(t,i,s),tickFormatter:D.sV}}addXSeriesAxis(e){const t=(0,o.map)(this.data,((e,t)=>[t+1,e.alias]));e.xaxis={timezone:this.dashboard.getTimezone(),show:this.panel.xaxis.show,mode:null,min:0,max:t.length+1,label:"Datetime",ticks:t}}addXHistogramAxis(e,t){let i,s,n;const a=this.panelWidth/50;if(this.data.length&&t){const e=[];for(const t of this.data)for(const i of t.data)e[i[0]]=!0;i=Object.keys(e).map((e=>Number(e))),s=(0,o.min)(i),n=(0,o.max)(i);let r=t,l=Math.floor((n-s)/r);for(;l>a;)r*=2,l=Math.ceil((n-s)/r);s=Math.floor(s/r)*r,n=Math.ceil(1.01*n/r)*r,i=[];for(let e=s;e<=n;e+=r)i.push(e)}else i=a/2,s=0,n=1;e.xaxis={timezone:this.dashboard.getTimezone(),show:this.panel.xaxis.show,mode:null,min:s,max:n,label:"Histogram",ticks:i},this.configureAxisMode(e.xaxis,"short",null)}addXTableAxis(e){let t=(0,o.map)(this.data,((e,t)=>(0,o.map)(e.datapoints,((i,s)=>[t*e.datapoints.length+s+1,i[1]]))));t=(0,o.flatten)(t,!0),e.xaxis={timezone:this.dashboard.getTimezone(),show:this.panel.xaxis.show,mode:null,min:0,max:t.length+1,label:"Datetime",ticks:t}}configureYAxisOptions(e,t){const i={position:"left",show:this.panel.yaxes[0].show,index:1,logBase:this.panel.yaxes[0].logBase||1,min:this.parseNumber(this.panel.yaxes[0].min),max:this.parseNumber(this.panel.yaxes[0].max),tickDecimals:this.panel.yaxes[0].decimals};if(t.yaxes.push(i),(0,o.find)(e,{yaxis:2})){const s=(0,o.clone)(i);s.index=2,s.show=this.panel.yaxes[1].show,s.logBase=this.panel.yaxes[1].logBase||1,s.position="right",s.min=this.parseNumber(this.panel.yaxes[1].min),s.max=this.parseNumber(this.panel.yaxes[1].max),s.tickDecimals=this.panel.yaxes[1].decimals,t.yaxes.push(s),this.applyLogScale(t.yaxes[1],e),this.configureAxisMode(t.yaxes[1],this.panel.percentage&&this.panel.stack?"percent":this.panel.yaxes[1].format,this.panel.yaxes[1].decimals)}this.applyLogScale(t.yaxes[0],e),this.configureAxisMode(t.yaxes[0],this.panel.percentage&&this.panel.stack?"percent":this.panel.yaxes[0].format,this.panel.yaxes[0].decimals)}parseNumber(e){return null==e?null:(0,o.toNumber)(e)}applyLogScale(e,t){if(1===e.logBase)return;const i=0===e.min;let s,n;e.min<Number.MIN_VALUE&&(e.min=null),e.max<Number.MIN_VALUE&&(e.max=null);let o=e.max,a=e.min;for(n=0;n<t.length;n++)s=t[n],s.yaxis===e.index&&((!o||o<s.stats.max)&&(o=s.stats.max),(!a||a>s.stats.logmin)&&(a=s.stats.logmin));e.transform=t=>t<Number.MIN_VALUE?null:Math.log(t)/Math.log(e.logBase),e.inverseTransform=t=>Math.pow(e.logBase,t),o||a?o?a||(a=o*e.inverseTransform(-4)):o=a*e.inverseTransform(4):(o=e.inverseTransform(2),a=e.inverseTransform(-2)),a=e.min?e.inverseTransform(Math.ceil(e.transform(e.min))):e.min=e.inverseTransform(Math.floor(e.transform(a))),o=e.max?e.inverseTransform(Math.floor(e.transform(e.max))):e.max=e.inverseTransform(Math.ceil(e.transform(o))),!a||a<Number.MIN_VALUE||!o||o<Number.MIN_VALUE||(Number.isFinite(a)&&Number.isFinite(o)?(i&&(e.min=.1,a=1),e.ticks=this.generateTicksForLogScaleYAxis(a,o,e.logBase),i&&e.ticks.unshift(.1),e.ticks[e.ticks.length-1]>e.max&&(e.max=e.ticks[e.ticks.length-1])):(e.ticks=[1,2],delete e.min,delete e.max))}generateTicksForLogScaleYAxis(e,t,i){let s,n=[];for(s=e;s<=t;s*=i)n.push(s);const o=Math.ceil(this.ctrl.height/25),a=n.length;if(a>o){const r=Math.ceil(a/o)*i;for(n=[],s=e;s<=t*r;s*=r)n.push(s)}return n}configureAxisMode(e,t,i){e.tickFormatter=(e,s)=>{const n=(0,M.Cf)(t);if(!n)throw new Error(`Unit '${t}' is not supported`);return(0,M.zc)(n(e,i))}}}function Ee(e,t,i){return{restrict:"A",template:"",link:(t,i)=>new De(t,i,e)}}function Ae(e,t,i){e.overrideMenu=[],e.currentOverrides=[],e.override=e.override||{},e.colorPickerModel={},e.addOverrideOption=(t,i,s)=>{const n={text:t,propertyName:i,index:e.overrideMenu.length,values:s,submenu:(0,o.map)(s,(e=>({text:String(e),value:e})))};e.overrideMenu.push(n)},e.setOverride=(t,i)=>{"color"!==t.propertyName?(e.override[t.propertyName]=i.value,"fillBelowTo"===t.propertyName&&(e.override.lines=!1,e.ctrl.addSeriesOverride({alias:i.value,lines:!1})),e.updateCurrentOverrides(),e.ctrl.render()):e.openColorSelector(e.override.color)},e.colorSelected=t=>{e.override.color=t,e.updateCurrentOverrides(),e.ctrl.render(),e.colorPickerModel.series.color=t},e.openColorSelector=s=>{e.colorPickerModel={autoClose:!0,colorSelected:e.colorSelected,series:{color:s}},i.show({element:t.find(".dropdown")[0],position:"top center",openOn:"click",template:'<series-color-picker-popover color="series.color" onColorChange="colorSelected" />',classNames:"drop-popover drop-popover--transparent",model:e.colorPickerModel,onClose:()=>{e.ctrl.render()}})},e.removeOverride=t=>{delete e.override[t.propertyName],e.updateCurrentOverrides(),e.ctrl.refresh()},e.getSeriesNames=()=>(0,o.map)(e.ctrl.seriesList,(e=>ce.QX.escapeHtml(e.alias))),e.updateCurrentOverrides=()=>{e.currentOverrides=[],(0,o.each)(e.overrideMenu,(t=>{const i=e.override[t.propertyName];(0,o.isUndefined)(i)||e.currentOverrides.push({name:t.text,propertyName:t.propertyName,value:String(i)})}))},e.addOverrideOption("Bars","bars",[!0,!1]),e.addOverrideOption("Lines","lines",[!0,!1]),e.addOverrideOption("Line fill","fill",[0,1,2,3,4,5,6,7,8,9,10]),e.addOverrideOption("Fill gradient","fillGradient",[0,1,2,3,4,5,6,7,8,9,10]),e.addOverrideOption("Line width","linewidth",[0,1,2,3,4,5,6,7,8,9,10]),e.addOverrideOption("Null point mode","nullPointMode",["connected","null","null as zero"]),e.addOverrideOption("Fill below to","fillBelowTo",e.getSeriesNames()),e.addOverrideOption("Staircase line","steppedLine",[!0,!1]),e.addOverrideOption("Dashes","dashes",[!0,!1]),e.addOverrideOption("Hidden Series","hiddenSeries",[!0,!1]),e.addOverrideOption("Dash Length","dashLength",[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),e.addOverrideOption("Dash Space","spaceLength",[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),e.addOverrideOption("Points","points",[!0,!1]),e.addOverrideOption("Points Radius","pointradius",[1,2,3,4,5]),e.addOverrideOption("Stack","stack",[!0,!1,"A","B","C","D"]),e.addOverrideOption("Color","color",["change"]),e.addOverrideOption("Y-axis","yaxis",[1,2]),e.addOverrideOption("Z-index","zindex",[-3,-2,-1,0,1,2,3]),e.addOverrideOption("Transform","transform",["constant","negative-Y"]),e.addOverrideOption("Legend","legend",[!0,!1]),e.addOverrideOption("Hide in tooltip","hideTooltip",[!0,!1]),e.updateCurrentOverrides()}function Le(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}E.hF.directive("grafanaGraph",Ee),Ae.$inject=["$scope","$element","popoverSrv"],E.ZP.controller("SeriesOverridesCtrl",Ae);class $e{constructor(e){Le(this,"panelCtrl",void 0),Le(this,"panel",void 0),Le(this,"disabled",!1),this.$scope=e}$onInit(){this.panel=this.panelCtrl.panel,this.panel.alert&&!A.ZP.unifiedAlertingEnabled&&(this.disabled=!0);const e=this.$scope.$on("$destroy",(()=>{this.panelCtrl.editingThresholds=!1,this.panelCtrl.render(),e()}));this.panelCtrl.editingThresholds=!0}addThreshold(){this.panel.thresholds.push({value:void 0,colorMode:"critical",op:"gt",fill:!0,line:!0,yaxis:"left"}),this.panelCtrl.render()}removeThreshold(e){this.panel.thresholds.splice(e,1),this.panelCtrl.render()}render(){this.panelCtrl.render()}onFillColorChange(e){return t=>{this.panel.thresholds[e].fillColor=t,this.render()}}onLineColorChange(e){return t=>{this.panel.thresholds[e].lineColor=t,this.render()}}onThresholdTypeChange(e){"custom"===this.panel.thresholds[e].colorMode&&(this.panel.thresholds[e].fillColor=re()(A.ZP.theme2.v1.palette.blue85).setAlpha(.2).toRgbString(),this.panel.thresholds[e].lineColor=re()(A.ZP.theme2.v1.palette.blue77).setAlpha(.6).toRgbString()),this.panelCtrl.render()}}function Ie(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}$e.$inject=["$scope"],E.ZP.directive("graphThresholdForm",(()=>({restrict:"E",templateUrl:"public/app/plugins/panel/graph/thresholds_form.html",controller:$e,bindToController:!0,controllerAs:"ctrl",scope:{panelCtrl:"="}})));class Pe{constructor(e){Ie(this,"panelCtrl",void 0),Ie(this,"panel",void 0),Ie(this,"disabled",!1),Ie(this,"colorModes",void 0),this.$scope=e}$onInit(){this.panel=this.panelCtrl.panel;const e=this.$scope.$on("$destroy",(()=>{this.panelCtrl.editingTimeRegions=!1,this.panelCtrl.render(),e()}));this.colorModes=(0,o.map)(Object.keys(Se),(e=>({key:e,value:Se[e].title}))),this.panelCtrl.editingTimeRegions=!0}render(){this.panelCtrl.render()}addTimeRegion(){this.panel.timeRegions.push({op:"time",fromDayOfWeek:void 0,from:void 0,toDayOfWeek:void 0,to:void 0,colorMode:"background6",fill:!0,line:!1,fillColor:"rgba(234, 112, 112, 0.12)",lineColor:"rgba(237, 46, 24, 0.60)"}),this.panelCtrl.render()}removeTimeRegion(e){this.panel.timeRegions.splice(e,1),this.panelCtrl.render()}onFillColorChange(e){return t=>{this.panel.timeRegions[e].fillColor=t,this.render()}}onLineColorChange(e){return t=>{this.panel.timeRegions[e].lineColor=t,this.render()}}}Pe.$inject=["$scope"],E.ZP.directive("graphTimeRegionForm",(()=>({restrict:"E",templateUrl:"public/app/plugins/panel/graph/time_regions_form.html",controller:Pe,bindToController:!0,controllerAs:"ctrl",scope:{panelCtrl:"="}})));var Re=i(50243);function je(e,t,i,s){function a(t){try{return e(t)}catch(e){return console.log("Could not sanitize annotation string, html escaping instead"),(0,o.escape)(t)}}return{restrict:"E",scope:{event:"=",onEdit:"&"},link:(e,i)=>{const r=e.event;let l=r.title,h=r.text;const d=t.getCurrent();let p='<div class="graph-annotation">',c="";if(void 0!==r.alertId&&r.newState){const e=Re.Z.getStateDisplayModel(r.newState);c=e.stateClass,l=`<i class="${e.iconClass}"></i> ${e.text}`,h=Re.Z.getAlertAnnotationInfo(r),r.text&&(h=h+"<br />"+r.text)}else l&&(h=l+"<br />"+((0,o.isString)(h)?h:""),l="");let u='<div class="graph-annotation__header">';r.login&&r.avatarUrl&&(u+=`<div class="graph-annotation__user" bs-tooltip="'Created by ${r.login}'"><img src="${r.avatarUrl}" /></div>`),u+=`\n          <span class="graph-annotation__title ${c}">${a(l)}</span>\n          <span class="graph-annotation__time">${null==d?void 0:d.formatDate(r.min)}</span>\n      `,r.id&&null!=d&&d.canEditAnnotations(r.dashboardId)&&(u+='\n          <span class="pointer graph-annotation__edit-icon" ng-click="onEdit()">\n            <i class="fa fa-pencil-square"></i>\n          </span>\n        '),u+="</div>",p+=u,p+='<div class="graph-annotation__body">',h&&(p+="<div ng-non-bindable>"+a(h.replace(/\n/g,"<br>"))+"</div>");const m=r.tags;m&&m.length&&(e.tags=m,p+='<span class="label label-tag small" ng-repeat="tag in tags" tag-color-from-name="tag">{{tag}}</span><br/>'),p+="</div>",p+="</div>";n()(p).appendTo(i),s(i.contents())(e)}}}je.$inject=["$sanitize","dashboardSrv","contextSrv","$compile"],E.ZP.directive("annotationTooltip",je);var Ne=i(59196),Fe=i(73144),We=i(45921);function ze(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Ve{constructor(){ze(this,"panelCtrl",void 0),ze(this,"event",void 0),ze(this,"timeRange",void 0),ze(this,"form",void 0),ze(this,"close",void 0),ze(this,"timeFormated",void 0)}$onInit(){this.event.panelId=this.panelCtrl.panel.id,this.event.dashboardUID=this.panelCtrl.dashboard.uid,this.event.time=He(this.event.time),this.event.isRegion&&(this.event.timeEnd=He(this.event.timeEnd)),this.timeFormated=this.panelCtrl.dashboard.formatDate(this.event.time)}canDelete(){var e,t;return!Ne.Vt.accessControlEnabled()||("dashboard"===this.event.source.type?!(null===(t=this.panelCtrl.dashboard.meta.annotationsPermissions)||void 0===t||!t.dashboard.canDelete):!(null===(e=this.panelCtrl.dashboard.meta.annotationsPermissions)||void 0===e||!e.organization.canDelete))}async save(){if(!this.form.$valid)return;const e=(0,o.cloneDeep)(this.event);if(e.time=e.time.valueOf(),e.timeEnd=0,e.isRegion&&(e.timeEnd=this.event.timeEnd.valueOf(),e.timeEnd<e.time))return void console.log("invalid time");let t=Fe.xD;e.id&&(t=Fe._E);try{await t(e)}catch(e){console.log(e)}finally{this.close(),(0,We.kt)().run({dashboard:this.panelCtrl.dashboard,range:this.panelCtrl.range})}}async delete(){try{await(0,Fe.Dl)(this.event)}catch(e){console.log(e)}finally{this.close(),(0,We.kt)().run({dashboard:this.panelCtrl.dashboard,range:this.panelCtrl.range})}}}function He(e){if(e&&(0,o.isNumber)(e)){const t=Number(e);return(0,C.CQ)(t)}return e}Ve.$inject=[],E.hF.directive("eventEditor",(function(){return{restrict:"E",controller:Ve,bindToController:!0,controllerAs:"ctrl",templateUrl:"public/app/features/annotations/partials/event_editor.html",scope:{panelCtrl:"=",event:"=",close:"&"}}}));var Be=i(18151),Ue=i(15399),Xe=i(80795),Ge=i(87978),Ze=i(72691),Ye=i(115),Ke=i(63454),qe=i(3420),Qe=i(26270),Je=i(8105);function et(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class tt{constructor(e){et(this,"source",void 0),et(this,"scope",void 0),et(this,"menuItemsSupplier",void 0),et(this,"scrollContextElement",null),et(this,"position",{x:0,y:0}),et(this,"isVisible",void 0),et(this,"onClose",(()=>{this.scrollContextElement&&this.scrollContextElement.removeEventListener("scroll",this.onClose),this.scope.$apply((()=>{this.isVisible=!1}))})),et(this,"toggleMenu",(e=>{this.isVisible=!this.isVisible,this.isVisible&&this.scrollContextElement&&this.scrollContextElement.addEventListener("scroll",this.onClose),this.source?this.position={x:this.source.pageX,y:this.source.pageY}:this.position={x:e?e.pageX:0,y:e?e.pageY:0}})),et(this,"setScrollContextElement",(e=>{this.scrollContextElement=e})),et(this,"setSource",(e=>{this.source=e})),et(this,"getSource",(()=>this.source)),et(this,"setMenuItemsSupplier",(e=>{this.menuItemsSupplier=e})),this.isVisible=!1,this.scope=e}}function it(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class st{constructor(e){it(this,"panel",void 0),it(this,"panelCtrl",void 0),it(this,"logScales",void 0),it(this,"xAxisModes",void 0),it(this,"xAxisStatOptions",void 0),it(this,"xNameSegment",void 0),it(this,"selectors",void 0),this.$scope=e,this.panelCtrl=e.ctrl,this.panel=this.panelCtrl.panel,this.$scope.ctrl=this,this.logScales={linear:1,"log (base 2)":2,"log (base 10)":10,"log (base 32)":32,"log (base 1024)":1024},this.xAxisModes={Time:"time",Series:"series",Histogram:"histogram"},this.xAxisStatOptions=[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Total",value:"total"},{text:"Count",value:"count"},{text:"Current",value:"current"}],"custom"===this.panel.xaxis.mode&&(this.panel.xaxis.name||(this.panel.xaxis.name="specify field")),this.selectors=W.wl.components.Panels.Visualization.Graph.VisualizationTab}setUnitFormat(e){return t=>{e.format=t,this.panel.fieldConfig.defaults.unit?(this.panel.fieldConfig.defaults.unit=void 0,this.panelCtrl.refresh()):this.panelCtrl.render()}}render(){this.panelCtrl.render()}xAxisModeChanged(){this.panelCtrl.processor.setPanelDefaultsForNewXAxisMode(),this.panelCtrl.onDataFramesReceived(this.panelCtrl.dataList)}xAxisValueChanged(){this.panelCtrl.onDataFramesReceived(this.panelCtrl.dataList)}}function nt(){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/graph/axes_editor.html",controller:st}}st.$inject=["$scope"];var ot=i(74461);function at(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class rt extends Ge.k{constructor(e,t){super(e,t),at(this,"renderError",!1),at(this,"hiddenSeries",{}),at(this,"hiddenSeriesTainted",!1),at(this,"seriesList",[]),at(this,"dataList",[]),at(this,"annotations",[]),at(this,"alertState",void 0),at(this,"dataWarning",void 0),at(this,"colors",[]),at(this,"subTabIndex",0),at(this,"processor",void 0),at(this,"contextMenuCtrl",void 0),at(this,"panelDefaults",{datasource:null,renderer:"flot",yaxes:[{label:null,show:!0,logBase:1,min:null,max:null,format:"short"},{label:null,show:!0,logBase:1,min:null,max:null,format:"short"}],xaxis:{show:!0,mode:"time",name:null,values:[],buckets:null},yaxis:{align:!1,alignLevel:null},lines:!0,fill:1,fillGradient:0,linewidth:1,dashes:!1,hiddenSeries:!1,dashLength:10,spaceLength:10,points:!1,pointradius:2,bars:!1,stack:!1,percentage:!1,legend:{show:!0,values:!1,min:!1,max:!1,current:!1,total:!1,avg:!1},nullPointMode:"null",steppedLine:!1,tooltip:{value_type:"individual",shared:!0,sort:0},timeFrom:null,timeShift:null,targets:[{}],aliasColors:{},seriesOverrides:[],thresholds:[],timeRegions:[],options:{alertThreshold:!0}}),at(this,"onColorChange",((e,t)=>{e.setColor(A.ZP.theme2.visualization.getColorByName(t)),this.panel.aliasColors[e.alias]=t,this.render()})),at(this,"onToggleSeries",(e=>{this.hiddenSeriesTainted=!0,this.hiddenSeries=e,this.render()})),at(this,"onToggleSort",((e,t)=>{this.panel.legend.sort=e,this.panel.legend.sortDesc=t,this.render()})),at(this,"onToggleAxis",(e=>{let t=(0,o.find)(this.panel.seriesOverrides,{alias:e.alias});t||(t={alias:e.alias},this.panel.seriesOverrides.push(t)),t.yaxis=e.yaxis,this.render()})),at(this,"onContextMenuClose",(()=>{this.contextMenuCtrl.toggleMenu()})),at(this,"getTimeZone",(()=>this.dashboard.getTimezone())),at(this,"getDataFrameByRefId",(e=>this.dataList.filter((t=>t.refId===e))[0])),(0,o.defaults)(this.panel,this.panelDefaults),(0,o.defaults)(this.panel.tooltip,this.panelDefaults.tooltip),(0,o.defaults)(this.panel.legend,this.panelDefaults.legend),(0,o.defaults)(this.panel.xaxis,this.panelDefaults.xaxis),(0,o.defaults)(this.panel.options,this.panelDefaults.options),this.useDataFrames=!0,this.processor=new ot.$(this.panel),this.contextMenuCtrl=new tt(e),this.events.on(b.Kh.render,this.onRender.bind(this)),this.events.on(b.Kh.dataFramesReceived,this.onDataFramesReceived.bind(this)),this.events.on(b.Kh.dataSnapshotLoad,this.onDataSnapshotLoad.bind(this)),this.events.on(b.Kh.editModeInitialized,this.onInitEditMode.bind(this)),this.events.on(b.Kh.initPanelActions,this.onInitPanelActions.bind(this));const i=this.panel.fieldConfig.defaults.unit;i&&(this.panel.yaxes[0].format=i)}onInitEditMode(){this.addEditorTab("Display","public/app/plugins/panel/graph/tab_display.html"),this.addEditorTab("Series overrides","public/app/plugins/panel/graph/tab_series_overrides.html"),this.addEditorTab("Axes",nt),this.addEditorTab("Legend","public/app/plugins/panel/graph/tab_legend.html"),this.addEditorTab("Thresholds","public/app/plugins/panel/graph/tab_thresholds.html"),this.addEditorTab("Time regions","public/app/plugins/panel/graph/tab_time_regions.html"),this.subTabIndex=0,this.hiddenSeriesTainted=!1}onInitPanelActions(e){e.push({text:"Toggle legend",click:"ctrl.toggleLegend()",shortcut:"p l"})}zoomOut(e){L.h$.publish(new Je.p8({scale:2}))}onDataSnapshotLoad(e){const{series:t,annotations:i}=(0,qe.y)(this.panel,this.dashboard);this.panelData.annotations=i,this.onDataFramesReceived(t)}onDataFramesReceived(e){var t;this.dataList=e,this.seriesList=this.processor.getSeriesList({dataList:this.dataList,range:this.range}),this.dataWarning=this.getDataWarning(),this.alertState=void 0,this.seriesList.alertState=void 0,this.panelData.alertState&&(this.alertState=this.panelData.alertState,this.seriesList.alertState=this.alertState.state),this.annotations=[],null!==(t=this.panelData.annotations)&&void 0!==t&&t.length&&(this.annotations=(0,Qe.em)(this.panelData.annotations)),this.loading=!1,this.render(this.seriesList)}getDataWarning(){if(0===this.seriesList.reduce(((e,t)=>e+t.datapoints.length),0)){if(this.dataList)for(const t of this.dataList){var e;if(t.length&&null!==(e=t.fields)&&void 0!==e&&e.length)return{title:"Unable to graph data",tip:"Data exists, but is not timeseries",actionText:"Switch to table view",action:()=>{(0,Ke.WI)((0,Ye.Kc)({panel:this.panel,pluginId:"table"}))}}}return{title:"No data",tip:"No data returned from query"}}for(const e of this.seriesList)if(!e.isOutsideRange)return;const t={title:"Data outside time range",tip:"Can be caused by timezone mismatch or missing time filter in query"},i=function(e){const t={from:Number.MAX_SAFE_INTEGER,to:Number.MIN_SAFE_INTEGER};let i=!1;const s=[Te.gz.min,Te.gz.max];for(const n of e)for(const e of n.fields)if(e.type===O.fS.time){const n=(0,Te.Kx)({field:e,reducers:s});t.from=Math.min(t.from,n[Te.gz.min]),t.to=Math.max(t.to,n[Te.gz.max]),i=!0}return i?t:void 0}(this.dataList);return i&&(t.actionText="Zoom to data",t.action=()=>{Xe.E1.partial({from:i.from,to:i.to})}),t}onRender(){if(this.seriesList){Ze.X.alertToGraphThresholds(this.panel);for(const e of this.seriesList)e.applySeriesOverrides(this.panel.seriesOverrides),e.unit&&(this.panel.yaxes[e.yaxis-1].format=e.unit),!1===this.hiddenSeriesTainted&&!0===e.hiddenSeries&&(this.hiddenSeries[e.alias]=!0)}}addSeriesOverride(e){this.panel.seriesOverrides.push(e||{})}removeSeriesOverride(e){this.panel.seriesOverrides=(0,o.without)(this.panel.seriesOverrides,e),this.render()}toggleLegend(){this.panel.legend.show=!this.panel.legend.show,this.render()}legendValuesOptionChanged(){const e=this.panel.legend;e.values=e.min||e.max||e.avg||e.current||e.total,this.render()}migrateToReact(){this.onPluginTypeChange(A.ZP.panels.timeseries)}}rt.$inject=["$scope","$injector"],at(rt,"template",'\n<div class="graph-panel" ng-class="{\'graph-panel--legend-right\': ctrl.panel.legend.rightSide}">\n  <div class="graph-panel__chart" grafana-graph ng-dblclick="ctrl.zoomOut()">\n  </div>\n\n  <div class="graph-legend">\n    <div class="graph-legend-content" graph-legend></div>\n  </div>\n  <div ng-if="ctrl.contextMenuCtrl.isVisible">\n    <graph-context-menu\n      itemsGroup="ctrl.contextMenuCtrl.menuItemsSupplier()"\n      on-close="ctrl.onContextMenuClose"\n      getContextMenuSource="ctrl.contextMenuCtrl.getSource"\n      timeZone="ctrl.getTimeZone()"\n      x="ctrl.contextMenuCtrl.position.x"\n      y="ctrl.contextMenuCtrl.position.y"\n    ></graph-context-menu>\n  </div>\n</div>\n');const lt=new Be.c(null).useFieldConfig({disableStandardOptions:[Ue.qb.NoValue,Ue.qb.Thresholds,Ue.qb.Max,Ue.qb.Min,Ue.qb.Decimals,Ue.qb.Color,Ue.qb.Mappings]}).setDataSupport({annotations:!0,alertStates:!0}).setMigrationHandler((e=>{var t;const i=null!==(t=e.fieldConfig)&&void 0!==t?t:{defaults:{},overrides:[]},s=e.options||{};return s.dataLinks&&(i.defaults.links=s.dataLinks,delete s.dataLinks),e.options=s,e.fieldConfig=i,s}));lt.angularPanelCtrl=rt}}]);
//# sourceMappingURL=graphPlugin.1dc7caae8e078d244ece.js.map